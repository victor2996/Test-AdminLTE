(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-794e98ca"],{"1dde":function(e,t,a){var i=a("d039"),n=a("b622"),r=a("2d00"),s=n("species");e.exports=function(e){return r>=51||!i((function(){var t=[],a=t.constructor={};return a[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},2506:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info-block"},[a("div",{staticClass:"btn btn-default info-block__close",on:{click:function(t){return e.$emit("remove")}}},[a("svg",{staticClass:"info-block__close-img",attrs:{viewBox:"0 0 8 8"}},[a("path",{attrs:{d:"M1.406 0l-1.406 1.406.688.719 1.781 1.781-1.781 1.781-.688.719 1.406 1.406.719-.688 1.781-1.781 1.781 1.781.719.688 1.406-1.406-.688-.719-1.781-1.781 1.781-1.781.688-.719-1.406-1.406-.719.688-1.781 1.781-1.781-1.781-.719-.688z",id:"x",fill:"rgba(0,0,0,0.7)"}})])]),a("img",{ref:"filePreview",staticClass:"info-block__image"})])},n=[],r=(a("b0c0"),{name:"SharesAddGallery",props:["data"],data:function(){return{dataSource:this.data}},methods:{previewImage:function(e){var t=this.$refs.filePreview,a=new FileReader;a.onload=function(e){t.src=e.target.result},a.readAsDataURL(e),this.dataSource.name=e.name,this.dataSource.imageFile=e}},mounted:function(){null!==this.dataSource.imageUrl&&void 0!==this.dataSource.imageUrl?this.$refs.filePreview.src=this.dataSource.imageUrl:this.previewImage(this.dataSource.imageFile)}}),s=r,o=(a("42a5"),a("2877")),l=Object(o["a"])(s,i,n,!1,null,"0dfc12e5",null);t["a"]=l.exports},"25f0":function(e,t,a){"use strict";var i=a("6eeb"),n=a("825a"),r=a("d039"),s=a("ad6d"),o="toString",l=RegExp.prototype,c=l[o],d=r((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=c.name!=o;(d||u)&&i(RegExp.prototype,o,(function(){var e=n(this),t=String(e.source),a=e.flags,i=String(void 0===a&&e instanceof RegExp&&!("flags"in l)?s.call(e):a);return"/"+t+"/"+i}),{unsafe:!0})},"2bf6":function(e,t,a){"use strict";a("8439")},"42a5":function(e,t,a){"use strict";a("c703")},"4de4":function(e,t,a){"use strict";var i=a("23e7"),n=a("b727").filter,r=a("1dde"),s=r("filter");i({target:"Array",proto:!0,forced:!s},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},"5b16":function(e,t,a){},"65f0":function(e,t,a){var i=a("861d"),n=a("e8b5"),r=a("b622"),s=r("species");e.exports=function(e,t){var a;return n(e)&&(a=e.constructor,"function"!=typeof a||a!==Array&&!n(a.prototype)?i(a)&&(a=a[s],null===a&&(a=void 0)):a=void 0),new(void 0===a?Array:a)(0===t?0:t)}},"66c0":function(e,t,a){"use strict";a("5b16")},"735d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block"},[a("div",{staticClass:"create"},[a("div",{staticClass:"create__status"},[a("div",{staticClass:"custom-control custom-switch custom-switch-on-success"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.pageData.status,expression:"pageData.status"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"customSwitch3"},domProps:{checked:Array.isArray(e.pageData.status)?e._i(e.pageData.status,null)>-1:e.pageData.status},on:{change:function(t){var a=e.pageData.status,i=t.target,n=!!i.checked;if(Array.isArray(a)){var r=null,s=e._i(a,r);i.checked?s<0&&e.$set(e.pageData,"status",a.concat([r])):s>-1&&e.$set(e.pageData,"status",a.slice(0,s).concat(a.slice(s+1)))}else e.$set(e.pageData,"status",n)}}}),e.pageData.status?a("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch3"}},[e._v(" Показывать ")]):a("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch3"}},[e._v("Не показывать ")])])]),a("div",{staticClass:"create__name d-flex"},[a("p",[e._v("Название")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.pageData.name,expression:"pageData.name"}],attrs:{type:"text",placeholder:"Название"},domProps:{value:e.pageData.name},on:{input:function(t){t.target.composing||e.$set(e.pageData,"name",t.target.value)}}})]),a("div",{staticClass:"create__description d-flex"},[a("p",[e._v("Описание")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.pageData.description,expression:"pageData.description"}],attrs:{type:"text",placeholder:"Описание"},domProps:{value:e.pageData.description},on:{input:function(t){t.target.composing||e.$set(e.pageData,"description",t.target.value)}}})]),a("div",{staticClass:"create__main-img d-flex"},[a("p",[e._v("Главная картинка")]),a("PagesAddImage",{attrs:{sourceData:e.pageData.mainImage},on:{mainImageChanged:e.mainImageFile}})],1),a("div",{staticClass:"create__gallery"},[a("p",[e._v("Галерея картинок")]),a("div",{staticClass:"d-flex"},[a("p",[e._v("Размер: 1000х190")]),a("div",{staticClass:"create__gallery-img d-flex flex-wrap"},[e._l(e.galleryData,(function(t,i){return a("PagesAddGallery",{key:t.name,staticClass:"gallery__block",attrs:{data:t},on:{remove:function(t){return e.galleryData.splice(i,1)}}})})),a("button",{staticClass:"btn btn-default gallery__block-add",on:{click:function(t){return e.openFileDialog()}}},[a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.addImage}}),e._v(" Добавить"),a("br"),e._v("фото ")])],2)])]),a("div",{staticClass:"create__seo d-flex"},[a("p",[e._v("SEO блок:")]),a("div",{staticClass:"create__seo-info"},[a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("URL:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.pageData.SEO.url,expression:"pageData.SEO.url"}],attrs:{type:"text",placeholder:"URL"},domProps:{value:e.pageData.SEO.url},on:{input:function(t){t.target.composing||e.$set(e.pageData.SEO,"url",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Title:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.pageData.SEO.title,expression:"pageData.SEO.title"}],attrs:{type:"text",placeholder:"Title"},domProps:{value:e.pageData.SEO.title},on:{input:function(t){t.target.composing||e.$set(e.pageData.SEO,"title",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Keywords:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.pageData.SEO.keyword,expression:"pageData.SEO.keyword"}],attrs:{type:"text",placeholder:"word"},domProps:{value:e.pageData.SEO.keyword},on:{input:function(t){t.target.composing||e.$set(e.pageData.SEO,"keyword",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Description:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.pageData.SEO.description,expression:"pageData.SEO.description"}],attrs:{type:"text",placeholder:"Description"},domProps:{value:e.pageData.SEO.description},on:{input:function(t){t.target.composing||e.$set(e.pageData.SEO,"description",t.target.value)}}})])])])]),a("button",{ref:"btnSave",staticClass:"btn btn-default btn-save",on:{click:e.mainImagePromise}},[e._v(" Сохранить ")])])},n=[],r=(a("b0c0"),a("d3b7"),a("4de4"),a("3ca3"),a("ddb0"),a("d81d"),a("99af"),a("25f0"),a("b64b"),a("e6df")),s=a("2506"),o=a("2591"),l={name:"PagesAddNew",components:{PagesAddImage:r["a"],PagesAddGallery:s["a"]},props:["dataOb","dbRef","dbMainImageRef","dbGalleryRef"],data:function(){return{ref:this.dbRef,mainImageRef:this.dbMainImageRef,galleryRef:this.dbGalleryRef,galleryData:[],pageData:{id:"",name:"",status:!1,date:"",description:"",galleryImages:[],SEO:{url:"",title:"",keyword:"",description:""}}}},methods:{openFileDialog:function(){this.$refs.fileDialog.click()},addImage:function(){var e=this.$refs.fileDialog.files[0];void 0!==e&&this.galleryData.push({name:e.name,imageFile:e})},mainImageFile:function(e){void 0!==e&&(this.pageData.mainImage=e)},mainImagePromise:function(){var e=this;this.$refs.btnSave.classList.add("show"),this.$refs.btnSave.textContent="Сохраняется";var t=o["a"].storage().ref(this.mainImageRef);void 0!==this.pageData.mainImage&&void 0===this.pageData.mainImage.imageUrl?new Promise((function(a){a(t.child(e.pageData.mainImage.name).put(e.pageData.mainImage).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return{name:e.pageData.mainImage.name,imageUrl:t}})))})).then((function(t){return e.galleryPromise(t)})):void 0!==this.pageData.mainImage&&void 0!==this.pageData.mainImage.imageUrl?this.galleryPromise(this.pageData.mainImage):(alert("Укажите главную картинку"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},galleryPromise:function(e){var t=this,a=o["a"].storage().ref(this.galleryRef);if(this.galleryData.length>0){var i=this.galleryData.filter((function(e){return void 0===e.id}));Promise.all(i.map((function(e){if(void 0!==e.imageFile)return new Promise((function(t){t(a.child(e.name).put(e.imageFile).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return e={id:Math.floor(1e4*Math.random()),name:e.name,imageUrl:t}})))}))}))).then((function(a){return t.saveData(e,a)}))}else alert("Выберете картинки для галереи"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show")},saveData:function(e,t){var a=this.galleryData.filter((function(e){return void 0!==e.id})),i=a.concat(t);this.onUpload(e,i)},onUpload:function(e,t){var a,i,n=new Date;1===n.getDate().toString().length&&(a="0"+n.getDate()),1===n.getMonth().toString().length&&(i="0"+n.getMonth());var r=n.getFullYear(),s="".concat(a,".").concat(i,".").concat(r);this.pageData.date=s,this.pageData.id=Math.floor(1e4*Math.random()),this.pageData.mainImage=e,this.pageData.galleryImages=t;var l=o["a"].database().ref(this.ref);l.set(this.pageData).then(this.$refs.btnSave.textContent="Сохранено").then(this.$refs.btnSave.classList.remove("show")).then(this.$router.push("/admin/pages"))}},created:function(){void 0!==this.dataOb&&0!==Object.keys(this.dataOb).length?(this.pageData=this.dataOb,0!==this.dataOb.galleryImages.length&&(this.galleryData=this.dataOb.galleryImages)):void 0===this.dataOb&&this.$router.push("/admin/pages")}},c=l,d=(a("66c0"),a("2877")),u=Object(d["a"])(c,i,n,!1,null,"0ab7d56e",null);t["default"]=u.exports},8418:function(e,t,a){"use strict";var i=a("c04e"),n=a("9bf2"),r=a("5c6c");e.exports=function(e,t,a){var s=i(t);s in e?n.f(e,s,r(0,a)):e[s]=a}},8439:function(e,t,a){},"99af":function(e,t,a){"use strict";var i=a("23e7"),n=a("d039"),r=a("e8b5"),s=a("861d"),o=a("7b0b"),l=a("50c4"),c=a("8418"),d=a("65f0"),u=a("1dde"),g=a("b622"),f=a("2d00"),m=g("isConcatSpreadable"),p=9007199254740991,v="Maximum allowed index exceeded",h=f>=51||!n((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),b=u("concat"),D=function(e){if(!s(e))return!1;var t=e[m];return void 0!==t?!!t:r(e)},y=!h||!b;i({target:"Array",proto:!0,forced:y},{concat:function(e){var t,a,i,n,r,s=o(this),u=d(s,0),g=0;for(t=-1,i=arguments.length;t<i;t++)if(r=-1===t?s:arguments[t],D(r)){if(n=l(r.length),g+n>p)throw TypeError(v);for(a=0;a<n;a++,g++)a in r&&c(u,g,r[a])}else{if(g>=p)throw TypeError(v);c(u,g++,r)}return u.length=g,u}})},ad6d:function(e,t,a){"use strict";var i=a("825a");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},b0c0:function(e,t,a){var i=a("83ab"),n=a("9bf2").f,r=Function.prototype,s=r.toString,o=/^\s*function ([^ (]*)/,l="name";i&&!(l in r)&&n(r,l,{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(e){return""}}})},b64b:function(e,t,a){var i=a("23e7"),n=a("7b0b"),r=a("df75"),s=a("d039"),o=s((function(){r(1)}));i({target:"Object",stat:!0,forced:o},{keys:function(e){return r(n(e))}})},b727:function(e,t,a){var i=a("0366"),n=a("44ad"),r=a("7b0b"),s=a("50c4"),o=a("65f0"),l=[].push,c=function(e){var t=1==e,a=2==e,c=3==e,d=4==e,u=6==e,g=7==e,f=5==e||u;return function(m,p,v,h){for(var b,D,y=r(m),_=n(y),w=i(p,v,3),x=s(_.length),S=0,I=h||o,C=t?I(m,x):a||g?I(m,0):void 0;x>S;S++)if((f||S in _)&&(b=_[S],D=w(b,S,y),e))if(t)C[S]=D;else if(D)switch(e){case 3:return!0;case 5:return b;case 6:return S;case 2:l.call(C,b)}else switch(e){case 4:return!1;case 7:l.call(C,b)}return u?-1:c||d?d:C}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},c703:function(e,t,a){},d81d:function(e,t,a){"use strict";var i=a("23e7"),n=a("b727").map,r=a("1dde"),s=r("map");i({target:"Array",proto:!0,forced:!s},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},e6df:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block flex-wrap"},[void 0!==e.imageData?a("img",{ref:"filePreview",staticClass:"preview",attrs:{src:e.imageData}}):e._e(),a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.addImage}}),void 0===e.imageData?a("button",{staticClass:"btn btn-default",on:{click:e.openFileDialog}},[e._v(" Добавить ")]):e._e(),void 0!==e.imageData?a("button",{staticClass:"btn btn-default info-block__remove",on:{click:e.deleteImage}},[e._v(" Удалить ")]):e._e()])},n=[],r={name:"SharesAddImage",props:["sourceData"],data:function(){return{imageData:this.sourceData}},methods:{openFileDialog:function(){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(e)},addImage:function(){var e=this.$refs.fileDialog.files[0];this.previewImage(e)},previewImage:function(e){var t=this,a=new FileReader;a.readAsDataURL(e),a.onload=function(e){t.imageData=e.target.result},this.$emit("mainImageChanged",e)},deleteImage:function(){this.imageData=void 0,this.$emit("mainImageChanged",void 0)}},mounted:function(){void 0!==this.imageData&&(null!==this.imageData.imageUrl&&void 0!==this.imageData.imageUrl?this.$refs.filePreview.src=this.imageData.imageUrl:this.previewImage(this.imageData.imageFile))}},s=r,o=(a("2bf6"),a("2877")),l=Object(o["a"])(s,i,n,!1,null,"2f611f0e",null);t["a"]=l.exports},e8b5:function(e,t,a){var i=a("c6b6");e.exports=Array.isArray||function(e){return"Array"==i(e)}}}]);
//# sourceMappingURL=chunk-794e98ca.ba33216a.js.map