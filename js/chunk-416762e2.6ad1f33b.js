(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-416762e2"],{"1dde":function(e,t,a){var i=a("d039"),r=a("b622"),n=a("2d00"),o=r("species");e.exports=function(e){return n>=51||!i((function(){var t=[],a=t.constructor={};return a[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"33b9":function(e,t,a){"use strict";a("8739")},"378b":function(e,t,a){"use strict";a("c6d3")},"42ea":function(e,t,a){},"4de4":function(e,t,a){"use strict";var i=a("23e7"),r=a("b727").filter,n=a("1dde"),o=n("filter");i({target:"Array",proto:!0,forced:!o},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"65f0":function(e,t,a){var i=a("861d"),r=a("e8b5"),n=a("b622"),o=n("species");e.exports=function(e,t){var a;return r(e)&&(a=e.constructor,"function"!=typeof a||a!==Array&&!r(a.prototype)?i(a)&&(a=a[o],null===a&&(a=void 0)):a=void 0),new(void 0===a?Array:a)(0===t?0:t)}},"7db0":function(e,t,a){"use strict";var i=a("23e7"),r=a("b727").find,n=a("44d2"),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),i({target:"Array",proto:!0,forced:s},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(o)},8418:function(e,t,a){"use strict";var i=a("c04e"),r=a("9bf2"),n=a("5c6c");e.exports=function(e,t,a){var o=i(t);o in e?r.f(e,o,n(0,a)):e[o]=a}},8739:function(e,t,a){},"99af":function(e,t,a){"use strict";var i=a("23e7"),r=a("d039"),n=a("e8b5"),o=a("861d"),s=a("7b0b"),l=a("50c4"),c=a("8418"),d=a("65f0"),u=a("1dde"),m=a("b622"),f=a("2d00"),v=m("isConcatSpreadable"),p=9007199254740991,g="Maximum allowed index exceeded",h=f>=51||!r((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),b=u("concat"),D=function(e){if(!o(e))return!1;var t=e[v];return void 0!==t?!!t:n(e)},y=!h||!b;i({target:"Array",proto:!0,forced:y},{concat:function(e){var t,a,i,r,n,o=s(this),u=d(o,0),m=0;for(t=-1,i=arguments.length;t<i;t++)if(n=-1===t?o:arguments[t],D(n)){if(r=l(n.length),m+r>p)throw TypeError(g);for(a=0;a<r;a++,m++)a in n&&c(u,m,n[a])}else{if(m>=p)throw TypeError(g);c(u,m++,n)}return u.length=m,u}})},a202:function(e,t,a){"use strict";a("42ea")},b0c0:function(e,t,a){var i=a("83ab"),r=a("9bf2").f,n=Function.prototype,o=n.toString,s=/^\s*function ([^ (]*)/,l="name";i&&!(l in n)&&r(n,l,{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(e){return""}}})},b64b:function(e,t,a){var i=a("23e7"),r=a("7b0b"),n=a("df75"),o=a("d039"),s=o((function(){n(1)}));i({target:"Object",stat:!0,forced:s},{keys:function(e){return n(r(e))}})},b727:function(e,t,a){var i=a("0366"),r=a("44ad"),n=a("7b0b"),o=a("50c4"),s=a("65f0"),l=[].push,c=function(e){var t=1==e,a=2==e,c=3==e,d=4==e,u=6==e,m=7==e,f=5==e||u;return function(v,p,g,h){for(var b,D,y=n(v),_=r(y),w=i(p,g,3),x=o(_.length),I=0,C=h||s,S=t?C(v,x):a||m?C(v,0):void 0;x>I;I++)if((f||I in _)&&(b=_[I],D=w(b,I,y),e))if(t)S[I]=D;else if(D)switch(e){case 3:return!0;case 5:return b;case 6:return I;case 2:l.call(S,b)}else switch(e){case 4:return!1;case 7:l.call(S,b)}return u?-1:c||d?d:S}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},c6d3:function(e,t,a){},ce94:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block"},[a("div",{staticClass:"create"},[a("div",{staticClass:"create__name d-flex"},[a("p",[e._v("Название фильма")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.name,expression:"movieData.name"}],attrs:{type:"text",placeholder:"Название фильма"},domProps:{value:e.movieData.name},on:{input:function(t){t.target.composing||e.$set(e.movieData,"name",t.target.value)}}})]),a("div",{staticClass:"create__description d-flex"},[a("p",[e._v("Описание")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.movieData.description,expression:"movieData.description"}],attrs:{type:"text",placeholder:"Описание"},domProps:{value:e.movieData.description},on:{input:function(t){t.target.composing||e.$set(e.movieData,"description",t.target.value)}}})]),a("div",{staticClass:"create__main-img d-flex"},[a("p",[e._v("Главная картинка")]),a("MoviesAddCurrentImage",{attrs:{sourceRef:e.mainImageRef,sourceData:e.mainImageData},on:{mainImageChanged:e.mainImageFile}})],1),a("div",{staticClass:"create__gallery"},[a("p",[e._v("Галерея картинок")]),a("div",{staticClass:"d-flex"},[a("p",[e._v("Размер: 1000х190")]),a("div",{staticClass:"create__gallery-img d-flex flex-wrap"},[e._l(e.galleryData,(function(t,i){return a("MoviesAddCurrentGallery",{key:t.name,staticClass:"gallery__block",attrs:{data:t,sourceRef:e.galleryRef},on:{remove:function(t){return e.galleryData.splice(i,1)}}})})),a("button",{staticClass:"btn btn-default gallery__block-add",on:{click:function(t){return e.openFileDialog()}}},[a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.addImage}}),e._v(" Добавить"),a("br"),e._v("фото ")])],2)])]),a("div",{staticClass:"create__trailer d-flex"},[a("p",[e._v("Ссылка на трейлер")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.trailer,expression:"movieData.trailer"}],attrs:{type:"text",placeholder:"Ссылка на видео в YouTube"},domProps:{value:e.movieData.trailer},on:{input:function(t){t.target.composing||e.$set(e.movieData,"trailer",t.target.value)}}})]),a("div",{staticClass:"create__movie-type d-flex"},[a("p",[e._v("Тип кино")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.type,expression:"movieData.type"}],attrs:{type:"radio",id:"3d",value:"3D"},domProps:{checked:e._q(e.movieData.type,"3D")},on:{change:function(t){return e.$set(e.movieData,"type","3D")}}}),a("label",{attrs:{for:"3d"}},[e._v("3D")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.type,expression:"movieData.type"}],attrs:{type:"radio",id:"2d",value:"2D"},domProps:{checked:e._q(e.movieData.type,"2D")},on:{change:function(t){return e.$set(e.movieData,"type","2D")}}}),a("label",{attrs:{for:"2d"}},[e._v("2D")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.type,expression:"movieData.type"}],attrs:{type:"radio",id:"imax",value:"IMAX"},domProps:{checked:e._q(e.movieData.type,"IMAX")},on:{change:function(t){return e.$set(e.movieData,"type","IMAX")}}}),a("label",{attrs:{for:"imax"}},[e._v("IMAX")])]),a("div",{staticClass:"create__seo d-flex"},[a("p",[e._v("SEO блок:")]),a("div",{staticClass:"create__seo-info"},[a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("URL:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.SEO.url,expression:"movieData.SEO.url"}],attrs:{type:"text",placeholder:"URL"},domProps:{value:e.movieData.SEO.url},on:{input:function(t){t.target.composing||e.$set(e.movieData.SEO,"url",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Title:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.SEO.title,expression:"movieData.SEO.title"}],attrs:{type:"text",placeholder:"Title"},domProps:{value:e.movieData.SEO.title},on:{input:function(t){t.target.composing||e.$set(e.movieData.SEO,"title",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Keywords:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.SEO.keyword,expression:"movieData.SEO.keyword"}],attrs:{type:"text",placeholder:"word"},domProps:{value:e.movieData.SEO.keyword},on:{input:function(t){t.target.composing||e.$set(e.movieData.SEO,"keyword",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Description:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.movieData.SEO.description,expression:"movieData.SEO.description"}],attrs:{type:"text",placeholder:"Description"},domProps:{value:e.movieData.SEO.description},on:{input:function(t){t.target.composing||e.$set(e.movieData.SEO,"description",t.target.value)}}})])])])]),a("div",{staticClass:"buttons"},[a("button",{ref:"btnSave",staticClass:"btn btn-default btn-save",on:{click:e.mainImagePromise}},[e._v(" Сохранить ")]),a("button",{ref:"btnRestore",staticClass:"btn btn-default btn-restore",on:{click:e.restore}},[e._v(" Вернуть базовую версию ")])])])},r=[],n=(a("b0c0"),a("d3b7"),a("4de4"),a("3ca3"),a("ddb0"),a("d81d"),a("7db0"),a("99af"),a("b64b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block flex-wrap"},[null!==e.imageData?a("img",{ref:"filePreview",staticClass:"preview",attrs:{src:e.imageData}}):e._e(),a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.addImage}}),null===e.imageData?a("button",{staticClass:"btn btn-default",on:{click:e.openFileDialog}},[e._v(" Добавить ")]):e._e(),null!==e.imageData?a("button",{staticClass:"btn btn-default info-block__remove",on:{click:e.deleteImage}},[e._v(" Удалить ")]):e._e()])}),o=[],s={name:"MoviesAddCurrentImage",props:["sourceRef","sourceData"],data:function(){return{imageRef:this.sourceRef,imageData:this.sourceData}},methods:{openFileDialog:function(){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(e)},addImage:function(){var e=this.$refs.fileDialog.files[0];this.previewImage(e)},previewImage:function(e){var t=this,a=new FileReader;a.readAsDataURL(e),a.onload=function(e){t.imageData=e.target.result},this.$emit("mainImageChanged",e)},deleteImage:function(){this.imageData=null,this.$emit("mainImageChanged",null)}}},l=s,c=(a("378b"),a("2877")),d=Object(c["a"])(l,n,o,!1,null,"2ecd2666",null),u=d.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info-block"},[a("div",{staticClass:"btn btn-default info-block__close",on:{click:function(t){return e.$emit("remove")}}},[a("svg",{staticClass:"info-block__close-img",attrs:{viewBox:"0 0 8 8"}},[a("path",{attrs:{d:"M1.406 0l-1.406 1.406.688.719 1.781 1.781-1.781 1.781-.688.719 1.406 1.406.719-.688 1.781-1.781 1.781 1.781.719.688 1.406-1.406-.688-.719-1.781-1.781 1.781-1.781.688-.719-1.406-1.406-.719.688-1.781 1.781-1.781-1.781-.719-.688z",id:"x",fill:"rgba(0,0,0,0.7)"}})])]),a("img",{ref:"filePreview",staticClass:"info-block__image"})])},f=[],v=a("2591"),p=(a("66ce"),a("588e"),{name:"MoviesAddCurrentGallery",props:["sourceRef","data"],data:function(){return{dataSource:this.data}},methods:{previewImage:function(e){var t=this.$refs.filePreview,a=new FileReader;a.onload=function(e){t.src=e.target.result},a.readAsDataURL(e),this.dataSource.name=e.name,this.dataSource.imageFile=e},onDownload:function(){var e=this;this.picture=null;var t=v["a"].storage().ref(this.imageRef).child("backcard");t.getDownloadURL().then((function(t){return e.picture=t}),(function(e){return console.log(e)}))}},mounted:function(){void 0!==this.dataSource.imageUrl?this.$refs.filePreview.src=this.dataSource.imageUrl:this.previewImage(this.dataSource.imageFile)}}),g=p,h=(a("a202"),Object(c["a"])(g,m,f,!1,null,"512a6c60",null)),b=h.exports,D={name:"MoviesAddCurrent",components:{MoviesAddCurrentImage:u,MoviesAddCurrentGallery:b},props:["dataArr","dataOb","dataImg","dbRef","dbMainImageRef","dbGalleryRef"],data:function(){return{dataArray:this.dataArr,dataObject:this.dataOb,dataImage:this.dataImg,ref:this.dbRef,mainImageRef:this.dbMainImageRef,galleryRef:this.dbGalleryRef,dataSource:[],galleryData:[],mainImageData:null,movieData:{id:"",name:"",description:"",mainImage:{},galleryImages:[],trailer:"",type:"",SEO:{url:"",title:"",keyword:"",description:""}}}},methods:{openFileDialog:function(){this.$refs.fileDialog.click()},addImage:function(){var e=this.$refs.fileDialog.files[0];void 0!==e&&this.galleryData.push({name:null,imageFile:e})},mainImageFile:function(e){null===e||(this.mainImageData=e)},mainImagePromise:function(){var e=this;this.$refs.btnSave.classList.add("show"),this.$refs.btnSave.textContent="Сохраняется";var t=v["a"].storage().ref(this.mainImageRef);void 0!==this.mainImageData.name?new Promise((function(a){a(t.child(e.mainImageData.name).put(e.mainImageData).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return{name:e.mainImageData.name,imageUrl:t}})))})).then((function(t){return e.galleryPromise(t)})):this.galleryPromise(this.movieData.mainImage)},galleryPromise:function(e){var t=this,a=v["a"].storage().ref(this.galleryRef);if(this.galleryData.length>0){var i=this.galleryData.filter((function(e){return void 0===e.id}));Promise.all(i.map((function(e){if(void 0!==e.imageFile)return new Promise((function(t){t(a.child(e.name).put(e.imageFile).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return e={id:Math.floor(1e4*Math.random()),name:e.name,imageUrl:t}})))}))}))).then((function(a){return t.saveData(e,a)}))}else alert("Выберете картинки для галереи")},saveData:function(e,t){var a=this,i=this.dataSource.find((function(e){return e.id===a.movieData.id}));if(void 0!==i){var r=this.galleryData.filter((function(e){return void 0!==e.id})),n=r.concat(t);this.onUpload(e,n)}else this.onUpload(e,t)},onUpload:function(e,t){var a=this,i=this.dataSource.filter((function(e){return e.id!==a.movieData.id}));this.movieData.id=Math.floor(1e4*Math.random()),this.movieData.mainImage=e,this.movieData.galleryImages=t,i.push(this.movieData);var r=v["a"].database().ref(this.ref);r.set(i).then(this.$refs.btnSave.textContent="Сохранено").then(this.$refs.btnSave.classList.remove("show")).then(this.$router.push("/admin/movies"))},restore:function(){var e=this,t=v["a"].database().ref(this.ref);t.on("value",(function(t){if(null!==t.val()){var a=t.val().find((function(t){return t.id===e.movieData.id}));e.movieData=a}}))}},created:function(){void 0!==this.dataArray&&this.dataArray.length>0?(this.dataSource=this.dataArray,void 0!==this.dataObject&&0!==Object.keys(this.dataObject).length&&(this.movieData=this.dataObject,this.galleryData=this.dataObject.galleryImages,this.mainImageData=this.dataImg)):this.$router.push("/admin/movies")}},y=D,_=(a("33b9"),Object(c["a"])(y,i,r,!1,null,"91d66f1c",null));t["default"]=_.exports},d81d:function(e,t,a){"use strict";var i=a("23e7"),r=a("b727").map,n=a("1dde"),o=n("map");i({target:"Array",proto:!0,forced:!o},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},e8b5:function(e,t,a){var i=a("c6b6");e.exports=Array.isArray||function(e){return"Array"==i(e)}}}]);
//# sourceMappingURL=chunk-416762e2.6ad1f33b.js.map