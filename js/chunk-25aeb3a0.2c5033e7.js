(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25aeb3a0"],{"0d67":function(a,e,t){},"4bd2":function(a,e,t){},"7db0":function(a,e,t){"use strict";var s=t("23e7"),i=t("b727").find,r=t("44d2"),n="find",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),s({target:"Array",proto:!0,forced:o},{find:function(a){return i(this,a,arguments.length>1?arguments[1]:void 0)}}),r(n)},"89e5":function(a,e,t){"use strict";t("4bd2")},a1a4:function(a,e,t){"use strict";t.r(e);var s=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"main-block"},[t("div",{staticClass:"create"},[t("div",{staticClass:"create__status"},[t("div",{staticClass:"custom-control custom-switch custom-switch-on-success"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.status,expression:"sharesData.status"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"customSwitch3"},domProps:{checked:Array.isArray(a.sharesData.status)?a._i(a.sharesData.status,null)>-1:a.sharesData.status},on:{change:function(e){var t=a.sharesData.status,s=e.target,i=!!s.checked;if(Array.isArray(t)){var r=null,n=a._i(t,r);s.checked?n<0&&a.$set(a.sharesData,"status",t.concat([r])):n>-1&&a.$set(a.sharesData,"status",t.slice(0,n).concat(t.slice(n+1)))}else a.$set(a.sharesData,"status",i)}}}),a.sharesData.status?t("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch3"}},[a._v(" Показывать ")]):t("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch3"}},[a._v("Не показывать ")])])]),t("div",{staticClass:"create__name d-flex"},[t("p",[a._v("Название акции")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.name,expression:"sharesData.name"}],attrs:{type:"text",placeholder:"Название акции"},domProps:{value:a.sharesData.name},on:{input:function(e){e.target.composing||a.$set(a.sharesData,"name",e.target.value)}}}),t("p",{staticClass:"date-title"},[a._v("Дата публикации")]),t("DatePicker",{staticClass:"date-title",attrs:{date:a.sharesData.date},on:{dateChange:a.newDateValue}})],1),t("div",{staticClass:"create__description d-flex"},[t("p",[a._v("Описание")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.description,expression:"sharesData.description"}],attrs:{type:"text",placeholder:"Описание"},domProps:{value:a.sharesData.description},on:{input:function(e){e.target.composing||a.$set(a.sharesData,"description",e.target.value)}}})]),t("div",{staticClass:"create__main-img d-flex"},[t("p",[a._v("Главная картинка")]),t("SharesAddImage",{attrs:{sourceData:a.sharesData.mainImage},on:{mainImageChanged:a.mainImageFile}})],1),t("div",{staticClass:"create__gallery"},[t("p",[a._v("Галерея картинок")]),t("div",{staticClass:"d-flex"},[t("p",[a._v("Размер: 1000х190")]),t("div",{staticClass:"create__gallery-img d-flex flex-wrap"},[a._l(a.galleryData,(function(e,s){return t("SharesAddGallery",{key:e.name,staticClass:"gallery__block",attrs:{data:e},on:{remove:function(e){return a.galleryData.splice(s,1)}}})})),t("button",{staticClass:"btn btn-default gallery__block-add",on:{click:function(e){return a.openFileDialog()}}},[t("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:a.addImage}}),a._v(" Добавить"),t("br"),a._v("фото ")])],2)])]),t("div",{staticClass:"create__link d-flex"},[t("p",[a._v("Ссылка на видео")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.link,expression:"sharesData.link"}],attrs:{type:"text",placeholder:"Ссылка на видео в YouTube"},domProps:{value:a.sharesData.link},on:{input:function(e){e.target.composing||a.$set(a.sharesData,"link",e.target.value)}}})]),t("div",{staticClass:"create__seo d-flex"},[t("p",[a._v("SEO блок:")]),t("div",{staticClass:"create__seo-info"},[t("div",{staticClass:"create__seo-info-block d-flex"},[t("p",[a._v("URL:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.SEO.url,expression:"sharesData.SEO.url"}],attrs:{type:"text",placeholder:"URL"},domProps:{value:a.sharesData.SEO.url},on:{input:function(e){e.target.composing||a.$set(a.sharesData.SEO,"url",e.target.value)}}})]),t("div",{staticClass:"create__seo-info-block d-flex"},[t("p",[a._v("Title:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.SEO.title,expression:"sharesData.SEO.title"}],attrs:{type:"text",placeholder:"Title"},domProps:{value:a.sharesData.SEO.title},on:{input:function(e){e.target.composing||a.$set(a.sharesData.SEO,"title",e.target.value)}}})]),t("div",{staticClass:"create__seo-info-block d-flex"},[t("p",[a._v("Keywords:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.SEO.keyword,expression:"sharesData.SEO.keyword"}],attrs:{type:"text",placeholder:"word"},domProps:{value:a.sharesData.SEO.keyword},on:{input:function(e){e.target.composing||a.$set(a.sharesData.SEO,"keyword",e.target.value)}}})]),t("div",{staticClass:"create__seo-info-block d-flex"},[t("p",[a._v("Description:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.sharesData.SEO.description,expression:"sharesData.SEO.description"}],attrs:{type:"text",placeholder:"Description"},domProps:{value:a.sharesData.SEO.description},on:{input:function(e){e.target.composing||a.$set(a.sharesData.SEO,"description",e.target.value)}}})])])])]),t("button",{ref:"btnSave",staticClass:"btn btn-default btn-save",on:{click:a.mainImagePromise}},[a._v(" Сохранить ")])])},i=[],r=(t("b0c0"),t("d3b7"),t("4de4"),t("3ca3"),t("ddb0"),t("d81d"),t("7db0"),t("99af"),t("b64b"),function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"main-block flex-wrap"},[void 0!==a.imageData?t("img",{ref:"filePreview",staticClass:"preview",attrs:{src:a.imageData}}):a._e(),t("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:a.addImage}}),void 0===a.imageData?t("button",{staticClass:"btn btn-default",on:{click:a.openFileDialog}},[a._v(" Добавить ")]):a._e(),void 0!==a.imageData?t("button",{staticClass:"btn btn-default info-block__remove",on:{click:a.deleteImage}},[a._v(" Удалить ")]):a._e()])}),n=[],o={name:"SharesAddImage",props:["sourceData"],data:function(){return{imageData:this.sourceData}},methods:{openFileDialog:function(){var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(a)},addImage:function(){var a=this.$refs.fileDialog.files[0];this.previewImage(a)},previewImage:function(a){var e=this,t=new FileReader;t.readAsDataURL(a),t.onload=function(a){e.imageData=a.target.result},this.$emit("mainImageChanged",a)},deleteImage:function(){this.imageData=void 0,this.$emit("mainImageChanged",void 0)}},mounted:function(){void 0!==this.imageData&&(null!==this.imageData.imageUrl&&void 0!==this.imageData.imageUrl?this.$refs.filePreview.src=this.imageData.imageUrl:this.previewImage(this.imageData.imageFile))}},l=o,c=(t("a8ce"),t("2877")),d=Object(c["a"])(l,r,n,!1,null,"0291ec7a",null),u=d.exports,h=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"info-block"},[t("div",{staticClass:"btn btn-default info-block__close",on:{click:function(e){return a.$emit("remove")}}},[t("svg",{staticClass:"info-block__close-img",attrs:{viewBox:"0 0 8 8"}},[t("path",{attrs:{d:"M1.406 0l-1.406 1.406.688.719 1.781 1.781-1.781 1.781-.688.719 1.406 1.406.719-.688 1.781-1.781 1.781 1.781.719.688 1.406-1.406-.688-.719-1.781-1.781 1.781-1.781.688-.719-1.406-1.406-.719.688-1.781 1.781-1.781-1.781-.719-.688z",id:"x",fill:"rgba(0,0,0,0.7)"}})])]),t("img",{ref:"filePreview",staticClass:"info-block__image"})])},m=[],f={name:"SharesAddGallery",props:["data"],data:function(){return{dataSource:this.data}},methods:{previewImage:function(a){var e=this.$refs.filePreview,t=new FileReader;t.onload=function(a){e.src=a.target.result},t.readAsDataURL(a),this.dataSource.name=a.name,this.dataSource.imageFile=a}},mounted:function(){null!==this.dataSource.imageUrl&&void 0!==this.dataSource.imageUrl?this.$refs.filePreview.src=this.dataSource.imageUrl:this.previewImage(this.dataSource.imageFile)}},v=f,g=(t("e33d"),Object(c["a"])(v,h,m,!1,null,"c61a6c4a",null)),p=g.exports,D=t("4dab"),b=t("2591"),_={name:"SharesAdd",components:{SharesAddImage:u,SharesAddGallery:p,DatePicker:D["a"]},props:["dataArr","dataOb","dbRef","dbMainImageRef","dbGalleryRef"],data:function(){return{ref:this.dbRef,mainImageRef:this.dbMainImageRef,galleryRef:this.dbGalleryRef,dataSource:[],galleryData:[],sharesData:{id:"",name:"",status:!1,date:"",description:"",galleryImages:[],link:"",SEO:{url:"",title:"",keyword:"",description:""}}}},methods:{openFileDialog:function(){this.$refs.fileDialog.click()},addImage:function(){var a=this.$refs.fileDialog.files[0];void 0!==a&&this.galleryData.push({name:a.name,imageFile:a})},mainImageFile:function(a){void 0!==a&&(this.sharesData.mainImage=a)},newDateValue:function(a){this.sharesData.date=a},mainImagePromise:function(){var a=this;this.$refs.btnSave.classList.add("show"),this.$refs.btnSave.textContent="Сохраняется";var e=b["a"].storage().ref(this.mainImageRef);void 0!==this.sharesData.mainImage&&void 0===this.sharesData.mainImage.imageUrl?new Promise((function(t){t(e.child(a.sharesData.mainImage.name).put(a.sharesData.mainImage).then((function(a){return a.ref.getDownloadURL()})).then((function(e){return{name:a.sharesData.mainImage.name,imageUrl:e}})))})).then((function(e){return a.galleryPromise(e)})):void 0!==this.sharesData.mainImage&&void 0!==this.sharesData.mainImage.imageUrl?this.galleryPromise(this.sharesData.mainImage):(alert("Укажите главную картинку"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},galleryPromise:function(a){var e=this,t=b["a"].storage().ref(this.galleryRef);if(this.galleryData.length>0){var s=this.galleryData.filter((function(a){return void 0===a.id}));Promise.all(s.map((function(a){if(void 0!==a.imageFile)return new Promise((function(e){e(t.child(a.name).put(a.imageFile).then((function(a){return a.ref.getDownloadURL()})).then((function(e){return a={id:Math.floor(1e4*Math.random()),name:a.name,imageUrl:e}})))}))}))).then((function(t){return e.saveData(a,t)}))}else alert("Выберете картинки для галереи"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show")},saveData:function(a,e){var t=this,s=this.dataSource.find((function(a){return a.id===t.sharesData.id}));if(void 0!==s){var i=this.galleryData.filter((function(a){return void 0!==a.id})),r=i.concat(e);this.onUpload(a,r)}else this.onUpload(a,e)},onUpload:function(a,e){var t=this,s=this.dataSource.filter((function(a){return a.id!==t.sharesData.id}));this.sharesData.id=Math.floor(1e4*Math.random()),this.sharesData.mainImage=a,this.sharesData.galleryImages=e,s.push(this.sharesData);var i=b["a"].database().ref(this.ref);i.set(s).then(this.$refs.btnSave.textContent="Сохранено").then(this.$refs.btnSave.classList.remove("show")).then(this.$router.push("/admin/shares"))}},created:function(){void 0!==this.dataArr&&this.dataArr.length>0?(this.dataSource=this.dataArr,void 0!==this.dataOb&&0!==Object.keys(this.dataOb).length&&(this.sharesData=this.dataOb,0!==this.dataOb.galleryImages.length&&(this.galleryData=this.dataOb.galleryImages))):void 0===this.dataArr&&this.$router.push("/admin/shares")}},y=_,w=(t("89e5"),Object(c["a"])(y,s,i,!1,null,"6a44828b",null));e["default"]=w.exports},a8ce:function(a,e,t){"use strict";t("e18f")},b0c0:function(a,e,t){var s=t("83ab"),i=t("9bf2").f,r=Function.prototype,n=r.toString,o=/^\s*function ([^ (]*)/,l="name";s&&!(l in r)&&i(r,l,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(a){return""}}})},d81d:function(a,e,t){"use strict";var s=t("23e7"),i=t("b727").map,r=t("1dde"),n=r("map");s({target:"Array",proto:!0,forced:!n},{map:function(a){return i(this,a,arguments.length>1?arguments[1]:void 0)}})},e18f:function(a,e,t){},e33d:function(a,e,t){"use strict";t("0d67")}}]);
//# sourceMappingURL=chunk-25aeb3a0.2c5033e7.js.map