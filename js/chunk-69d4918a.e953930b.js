(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69d4918a"],{"02e7":function(a,t,e){},"1dde":function(a,t,e){var i=e("d039"),n=e("b622"),r=e("2d00"),s=n("species");a.exports=function(a){return r>=51||!i((function(){var t=[],e=t.constructor={};return e[s]=function(){return{foo:1}},1!==t[a](Boolean).foo}))}},"28f4":function(a,t,e){"use strict";e("990c")},"2d08":function(a,t,e){"use strict";e("02e7")},"4de4":function(a,t,e){"use strict";var i=e("23e7"),n=e("b727").filter,r=e("1dde"),s=r("filter");i({target:"Array",proto:!0,forced:!s},{filter:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}})},6534:function(a,t,e){},"65f0":function(a,t,e){var i=e("861d"),n=e("e8b5"),r=e("b622"),s=r("species");a.exports=function(a,t){var e;return n(a)&&(e=a.constructor,"function"!=typeof e||e!==Array&&!n(e.prototype)?i(e)&&(e=e[s],null===e&&(e=void 0)):e=void 0),new(void 0===e?Array:e)(0===t?0:t)}},"7db0":function(a,t,e){"use strict";var i=e("23e7"),n=e("b727").find,r=e("44d2"),s="find",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{find:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}}),r(s)},8418:function(a,t,e){"use strict";var i=e("c04e"),n=e("9bf2"),r=e("5c6c");a.exports=function(a,t,e){var s=i(t);s in a?n.f(a,s,r(0,e)):a[s]=e}},"92c2":function(a,t,e){"use strict";e("9cbc")},"990c":function(a,t,e){},"99af":function(a,t,e){"use strict";var i=e("23e7"),n=e("d039"),r=e("e8b5"),s=e("861d"),o=e("7b0b"),l=e("50c4"),c=e("8418"),d=e("65f0"),m=e("1dde"),u=e("b622"),f=e("2d00"),h=u("isConcatSpreadable"),g=9007199254740991,v="Maximum allowed index exceeded",p=f>=51||!n((function(){var a=[];return a[h]=!1,a.concat()[0]!==a})),D=m("concat"),b=function(a){if(!s(a))return!1;var t=a[h];return void 0!==t?!!t:r(a)},_=!p||!D;i({target:"Array",proto:!0,forced:_},{concat:function(a){var t,e,i,n,r,s=o(this),m=d(s,0),u=0;for(t=-1,i=arguments.length;t<i;t++)if(r=-1===t?s:arguments[t],b(r)){if(n=l(r.length),u+n>g)throw TypeError(v);for(e=0;e<n;e++,u++)e in r&&c(m,u,r[e])}else{if(u>=g)throw TypeError(v);c(m,u++,r)}return m.length=u,m}})},"9cbc":function(a,t,e){},ab4a:function(a,t,e){"use strict";e("6534")},b0c0:function(a,t,e){var i=e("83ab"),n=e("9bf2").f,r=Function.prototype,s=r.toString,o=/^\s*function ([^ (]*)/,l="name";i&&!(l in r)&&n(r,l,{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(a){return""}}})},b64b:function(a,t,e){var i=e("23e7"),n=e("7b0b"),r=e("df75"),s=e("d039"),o=s((function(){r(1)}));i({target:"Object",stat:!0,forced:o},{keys:function(a){return r(n(a))}})},b727:function(a,t,e){var i=e("0366"),n=e("44ad"),r=e("7b0b"),s=e("50c4"),o=e("65f0"),l=[].push,c=function(a){var t=1==a,e=2==a,c=3==a,d=4==a,m=6==a,u=7==a,f=5==a||m;return function(h,g,v,p){for(var D,b,_=r(h),y=n(_),S=i(g,v,3),w=s(y.length),C=0,I=p||o,x=t?I(h,w):e||u?I(h,0):void 0;w>C;C++)if((f||C in y)&&(D=y[C],b=S(D,C,_),a))if(t)x[C]=b;else if(b)switch(a){case 3:return!0;case 5:return D;case 6:return C;case 2:l.call(x,D)}else switch(a){case 4:return!1;case 7:l.call(x,D)}return m?-1:c||d?d:x}};a.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},bbcb:function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main-block"},[e("div",{staticClass:"create"},[e("div",{staticClass:"create__name d-flex"},[e("p",[a._v("Название кинотеатра")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.name,expression:"cinemaData.name"}],attrs:{type:"text",placeholder:"Название кинотеатра"},domProps:{value:a.cinemaData.name},on:{input:function(t){t.target.composing||a.$set(a.cinemaData,"name",t.target.value)}}})]),e("div",{staticClass:"create__description d-flex"},[e("p",[a._v("Описание")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.description,expression:"cinemaData.description"}],attrs:{type:"text",placeholder:"Описание"},domProps:{value:a.cinemaData.description},on:{input:function(t){t.target.composing||a.$set(a.cinemaData,"description",t.target.value)}}})]),e("div",{staticClass:"create__conditions d-flex"},[e("p",[a._v("Условия")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.conditions,expression:"cinemaData.conditions"}],attrs:{type:"text",placeholder:"Условия"},domProps:{value:a.cinemaData.conditions},on:{input:function(t){t.target.composing||a.$set(a.cinemaData,"conditions",t.target.value)}}})]),e("div",{staticClass:"create__main-img d-flex"},[e("p",[a._v("Логотип")]),e("CinemaAddLogoImage",{attrs:{sourceRef:a.mainImageRef,sourceData:a.mainImageData},on:{mainImageChanged:a.mainImageFile}})],1),e("div",{staticClass:"create__main-img d-flex"},[e("p",[a._v("Фото верхнего баннера")]),e("CinemaAddBannerImage",{attrs:{sourceRef:a.topBannerRef,sourceData:a.topBannerData},on:{topBannerChanged:a.topBannerFile}})],1),e("div",{staticClass:"create__gallery"},[e("p",[a._v("Галерея картинок")]),e("div",{staticClass:"d-flex"},[e("p",[a._v("Размер: 1000х190")]),e("div",{staticClass:"create__gallery-img d-flex flex-wrap"},[a._l(a.galleryData,(function(t,i){return e("CinemaAddGallery",{key:t.name,staticClass:"gallery__block",attrs:{data:t,sourceRef:a.galleryRef},on:{remove:function(t){return a.galleryData.splice(i,1)}}})})),e("button",{staticClass:"btn btn-default gallery__block-add",on:{click:function(t){return a.openFileDialog()}}},[e("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:a.addImage}}),a._v(" Добавить"),e("br"),a._v("фото ")])],2)])]),e("div",{staticClass:"create__hall-list"},[e("h5",[a._v("Список Залов")]),a._m(0),a._l(a.hallData,(function(t,i){return e("HallList",{key:t.id,attrs:{data:t,dataArrS:a.dataSource,dataObS:a.cinemaData,dataImgS:a.mainImageData,dataBannerS:a.topBannerData,dataGalleryS:a.galleryData,hallDataS:a.hallData},on:{remove:function(t){return a.hallData.splice(i,1)}}})})),e("router-link",{staticClass:"btn btn-default hall-list-add",attrs:{tag:"button",to:{name:"HallAdd",params:{way:"add-hall",dataArrS:a.dataSource,dataObS:a.cinemaData,dataImgS:a.mainImageData,dataBannerS:a.topBannerData,dataGalleryS:a.galleryData,hallDataS:a.hallData}}}},[e("span"),a._v(" Создать Зал ")])],2),e("div",{staticClass:"create__seo d-flex"},[e("p",[a._v("SEO блок:")]),e("div",{staticClass:"create__seo-info"},[e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("URL:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.SEO.url,expression:"cinemaData.SEO.url"}],attrs:{type:"text",placeholder:"URL"},domProps:{value:a.cinemaData.SEO.url},on:{input:function(t){t.target.composing||a.$set(a.cinemaData.SEO,"url",t.target.value)}}})]),e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("Title:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.SEO.title,expression:"cinemaData.SEO.title"}],attrs:{type:"text",placeholder:"Title"},domProps:{value:a.cinemaData.SEO.title},on:{input:function(t){t.target.composing||a.$set(a.cinemaData.SEO,"title",t.target.value)}}})]),e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("Keywords:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.SEO.keyword,expression:"cinemaData.SEO.keyword"}],attrs:{type:"text",placeholder:"word"},domProps:{value:a.cinemaData.SEO.keyword},on:{input:function(t){t.target.composing||a.$set(a.cinemaData.SEO,"keyword",t.target.value)}}})]),e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("Description:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.cinemaData.SEO.description,expression:"cinemaData.SEO.description"}],attrs:{type:"text",placeholder:"Description"},domProps:{value:a.cinemaData.SEO.description},on:{input:function(t){t.target.composing||a.$set(a.cinemaData.SEO,"description",t.target.value)}}})])])])]),e("button",{ref:"btnSave",staticClass:"btn btn-default btn-save",on:{click:a.mainImagePromise}},[a._v(" Сохранить ")])])},n=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"title title-main"},[e("div",{staticClass:"title__name"},[a._v("Название")]),e("div",{staticClass:"title__date"},[a._v("Дата создания")])])}],r=(e("b0c0"),e("d3b7"),e("b64b"),e("4de4"),e("3ca3"),e("ddb0"),e("d81d"),e("7db0"),e("99af"),function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main-block flex-wrap"},[void 0!==a.imageData?e("img",{ref:"filePreview",staticClass:"preview",attrs:{src:a.imageData}}):a._e(),e("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:a.addImage}}),void 0===a.imageData?e("button",{staticClass:"btn btn-default",on:{click:a.openFileDialog}},[a._v(" Добавить ")]):a._e(),void 0!==a.imageData?e("button",{staticClass:"btn btn-default info-block__remove",on:{click:a.deleteImage}},[a._v(" Удалить ")]):a._e()])}),s=[],o={name:"CinemaAddLogoImage",props:["sourceRef","sourceData"],data:function(){return{imageRef:this.sourceRef,imageData:this.sourceData}},methods:{openFileDialog:function(){var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(a)},addImage:function(){var a=this.$refs.fileDialog.files[0];this.previewImage(a)},previewImage:function(a){var t=this,e=new FileReader;e.readAsDataURL(a),e.onload=function(a){t.imageData=a.target.result},this.$emit("mainImageChanged",a)},deleteImage:function(){this.imageData=void 0,this.$emit("mainImageChanged",void 0)}},mounted:function(){var a=this;if(void 0!==this.imageData)if(void 0!==this.imageData.name){var t=new FileReader;t.readAsDataURL(this.imageData),t.onload=function(t){a.imageData=t.target.result},this.$emit("topBannerChanged",this.imageData)}else this.$refs.filePreview.src=this.imageData}},l=o,c=(e("92c2"),e("2877")),d=Object(c["a"])(l,r,s,!1,null,"5f8e0130",null),m=d.exports,u=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main-block flex-wrap"},[void 0!==a.imageData?e("img",{ref:"filePreview",staticClass:"preview",attrs:{src:a.imageData}}):a._e(),e("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:a.addImage}}),void 0===a.imageData?e("button",{staticClass:"btn btn-default",on:{click:a.openFileDialog}},[a._v(" Добавить ")]):a._e(),void 0!==a.imageData?e("button",{staticClass:"btn btn-default info-block__remove",on:{click:a.deleteImage}},[a._v(" Удалить ")]):a._e()])},f=[],h={name:"CinemaAddBannerImage",props:["sourceRef","sourceData"],data:function(){return{imageRef:this.sourceRef,imageData:this.sourceData}},methods:{openFileDialog:function(){var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(a)},addImage:function(){var a=this.$refs.fileDialog.files[0];this.previewImage(a)},previewImage:function(a){var t=this,e=new FileReader;e.readAsDataURL(a),e.onload=function(a){t.imageData=a.target.result},this.$emit("topBannerChanged",a)},deleteImage:function(){this.imageData=void 0,this.$emit("topBannerChanged",void 0)}},mounted:function(){var a=this;if(void 0!==this.imageData)if(void 0!==this.imageData.name){var t=new FileReader;t.readAsDataURL(this.imageData),t.onload=function(t){a.imageData=t.target.result},this.$emit("topBannerChanged",this.imageData)}else this.$refs.filePreview.src=this.imageData}},g=h,v=(e("e884"),Object(c["a"])(g,u,f,!1,null,"ca1eedae",null)),p=v.exports,D=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"info-block"},[e("div",{staticClass:"btn btn-default info-block__close",on:{click:function(t){return a.$emit("remove")}}},[e("svg",{staticClass:"info-block__close-img",attrs:{viewBox:"0 0 8 8"}},[e("path",{attrs:{d:"M1.406 0l-1.406 1.406.688.719 1.781 1.781-1.781 1.781-.688.719 1.406 1.406.719-.688 1.781-1.781 1.781 1.781.719.688 1.406-1.406-.688-.719-1.781-1.781 1.781-1.781.688-.719-1.406-1.406-.719.688-1.781 1.781-1.781-1.781-.719-.688z",id:"x",fill:"rgba(0,0,0,0.7)"}})])]),e("img",{ref:"filePreview",staticClass:"info-block__image"})])},b=[],_={name:"CinemaAddGallery",props:["sourceRef","data"],data:function(){return{dataSource:this.data}},methods:{previewImage:function(a){var t=this.$refs.filePreview,e=new FileReader;e.onload=function(a){t.src=a.target.result},e.readAsDataURL(a),this.dataSource.name=a.name,this.dataSource.imageFile=a}},mounted:function(){null!==this.dataSource.imageUrl&&void 0!==this.dataSource.imageUrl?this.$refs.filePreview.src=this.dataSource.imageUrl:this.previewImage(this.dataSource.imageFile)}},y=_,S=(e("28f4"),Object(c["a"])(y,D,b,!1,null,"21ee627c",null)),w=S.exports,C=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"title__name"},[a._v(a._s(a.dataSource.number))]),e("div",{staticClass:"title__date"},[a._v(a._s(a.dataSource.date))]),e("router-link",{staticClass:"title__edit",attrs:{tag:"div",to:{name:"HallAdd",params:{way:"add-hall",dataArrS:a.cinemaDataArr,dataObS:a.cinemaDataOb,dataImgS:a.mainImageData,dataBannerS:a.topBannerData,dataGalleryS:a.galleryData,hallDataS:a.hallDataArr,hallDataObS:a.dataSource}}}},[e("div",{staticClass:"icon fas fa-pen"})]),e("div",{staticClass:"title__remove fas fa-trash",on:{click:function(t){return a.$emit("remove")}}})],1)},I=[],x={name:"HallList",props:["data","dataArrS","dataObS","dataImgS","dataBannerS","dataGalleryS","hallDataS"],data:function(){return{dataSource:this.data,cinemaDataArr:this.dataArrS,cinemaDataOb:this.dataObS,mainImageData:this.dataImgS,topBannerData:this.dataBannerS,galleryData:this.dataGalleryS,hallDataArr:this.hallDataS}}},A=x,O=(e("2d08"),Object(c["a"])(A,C,I,!1,null,"40aac3fe",null)),$=O.exports,k=e("2591"),B={name:"CinemaAdd",components:{CinemaAddLogoImage:m,CinemaAddBannerImage:p,CinemaAddGallery:w,HallList:$},props:["dataArr","dataOb","dataImg","dataBanner","dataGallery","dataHall","dbRef","dbMainImageRef","dbTopBannerRef","dbGalleryRef"],data:function(){return{cinemaDataArr:this.dataArr,cinemaDataOb:this.dataOb,mainImageData:this.dataImg,topBannerData:this.dataBanner,galleryDataArr:this.dataGallery,hallDataArr:this.dataHall,dataSource:[],galleryData:[],hallData:[],ref:this.dbRef,mainImageRef:this.dbMainImageRef,topBannerRef:this.dbTopBannerRef,galleryRef:this.dbGalleryRef,cinemaData:{id:"",name:"",description:"",conditions:"",mainImage:{},topBanner:{},galleryImages:[],hallList:[],SEO:{url:"",title:"",keyword:"",description:""}}}},methods:{openFileDialog:function(){this.$refs.fileDialog.click()},addImage:function(){var a=this.$refs.fileDialog.files[0];void 0!==a&&this.galleryData.push({name:a.name,imageFile:a})},mainImageFile:function(a){void 0!==a&&(this.mainImageData=a)},topBannerFile:function(a){void 0!==a&&(this.topBannerData=a)},mainImagePromise:function(){var a=this;this.$refs.btnSave.classList.add("show"),this.$refs.btnSave.textContent="Сохраняется";var t=k["a"].storage().ref(this.mainImageRef);void 0!==this.mainImageData.name?new Promise((function(e){e(t.child(a.mainImageData.name).put(a.mainImageData).then((function(a){return a.ref.getDownloadURL()})).then((function(t){return{name:a.mainImageData.name,imageUrl:t}})))})).then((function(t){return a.topBannerPromise(t)})):0!==Object.keys(this.cinemaData.mainImage).length?this.topBannerPromise(this.cinemaData.mainImage):(alert("Укажите логотип"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},topBannerPromise:function(a){var t=this,e=k["a"].storage().ref(this.topBannerRef);void 0!==this.topBannerData.name?new Promise((function(a){a(e.child(t.topBannerData.name).put(t.topBannerData).then((function(a){return a.ref.getDownloadURL()})).then((function(a){return{name:t.topBannerData.name,imageUrl:a}})))})).then((function(e){return t.galleryPromise(a,e)})):0!==Object.keys(this.cinemaData.topBanner).length?this.galleryPromise(a,this.cinemaData.topBanner):(alert("Укажите баннер"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},galleryPromise:function(a,t){var e=this,i=k["a"].storage().ref(this.galleryRef);if(this.galleryData.length>0){var n=this.galleryData.filter((function(a){return void 0===a.id}));Promise.all(n.map((function(a){if(void 0!==a.imageFile)return new Promise((function(t){t(i.child(a.name).put(a.imageFile).then((function(a){return a.ref.getDownloadURL()})).then((function(t){return a={id:Math.floor(1e4*Math.random()),name:a.name,imageUrl:t}})))}))}))).then((function(i){return e.saveData(a,t,i)}))}else alert("Выберете картинки для галереи"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show")},saveData:function(a,t,e){var i=this,n=this.dataSource.find((function(a){return a.id===i.cinemaData.id}));if(void 0!==n){var r=this.galleryData.filter((function(a){return void 0!==a.id})),s=r.concat(e);this.onUpload(a,t,s)}else this.onUpload(a,t,e)},onUpload:function(a,t,e){var i=this,n=this.dataSource.filter((function(a){return a.id!==i.cinemaData.id}));this.cinemaData.id=Math.floor(1e4*Math.random()),this.cinemaData.mainImage=a,this.cinemaData.topBanner=t,this.cinemaData.galleryImages=e,this.cinemaData.hallList=this.hallData,n.push(this.cinemaData);var r=k["a"].database().ref(this.ref);r.set(n).then(this.$refs.btnSave.textContent="Сохранено").then(this.$refs.btnSave.classList.remove("show")).then(this.$router.push("/admin/cinema"))}},created:function(){void 0!==this.cinemaDataArr&&this.cinemaDataArr.length>0?(this.dataSource=this.cinemaDataArr,void 0!==this.cinemaDataOb&&0!==Object.keys(this.cinemaDataOb).length&&(this.cinemaData=this.cinemaDataOb,0!==this.cinemaDataOb.galleryImages.length?this.galleryData=this.cinemaDataOb.galleryImages:this.galleryData=this.galleryDataArr,void 0!==this.hallDataArr&&this.hallDataArr.length>0&&(this.hallData=this.hallDataArr))):this.$router.push("/admin/cinema")}},R=B,E=(e("ab4a"),Object(c["a"])(R,i,n,!1,null,"32cdb84c",null));t["default"]=E.exports},d81d:function(a,t,e){"use strict";var i=e("23e7"),n=e("b727").map,r=e("1dde"),s=r("map");i({target:"Array",proto:!0,forced:!s},{map:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}})},e884:function(a,t,e){"use strict";e("feb5")},e8b5:function(a,t,e){var i=e("c6b6");a.exports=Array.isArray||function(a){return"Array"==i(a)}},feb5:function(a,t,e){}}]);
//# sourceMappingURL=chunk-69d4918a.e953930b.js.map