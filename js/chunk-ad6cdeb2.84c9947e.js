(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad6cdeb2"],{"15ce":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block"},[a("div",{staticClass:"block block-sms"},[a("h2",[e._v("SMS")]),a("MailingsSms",{attrs:{usersData:e.usersData}})],1),a("div",{staticClass:"block block-email"},[a("h2",[e._v("E-Mail")]),a("MailingsEmail",{attrs:{usersData:e.usersData}})],1)])},s=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mailings__choose d-flex"},[a("p",[e._v("Выбрать пользователей для рассылки")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.select,expression:"select"}],attrs:{type:"radio",id:"all",value:"all"},domProps:{checked:e._q(e.select,"all")},on:{click:function(t){return e.selectUsers(!0)},change:function(t){e.select="all"}}}),a("label",{attrs:{for:"all"}},[e._v("Все пользователи")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.select,expression:"select"}],attrs:{type:"radio",id:"select",value:"select"},domProps:{checked:e._q(e.select,"select")},on:{click:function(t){return e.selectUsers(!1)},change:function(t){e.select="select"}}}),a("label",{attrs:{for:"select"}},[e._v("Выборочно")]),a("router-link",{staticClass:"users-choose btn btn-default",attrs:{disabled:"select"!==e.select,tag:"button",to:{name:"MailingsChoose",params:{way:"users-choose",usersData:e.usersData,message:e.text,mailingsData:e.mailingsData,ref:e.ref}}}},[e._v(" Выбрать пользователей ")])],1),a("div",{staticClass:"mailings__text"},[a("div",{staticClass:"mailings__text-info d-flex"},[a("p",[e._v("Текст SMS")]),a("p",[e._v("Символов: "+e._s(e.textLength))]),a("p",[e._v("Количество SMS: "+e._s(e.smsLength))])]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],attrs:{placeholder:"Введите текст"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}})]),a("div",{staticClass:"mailings-start"},[a("button",{staticClass:"btn btn-default",attrs:{disabled:e.textLength<1},on:{click:function(t){return e.startMeiling()}}},[e._v(" Начать рассылку ")])])])},l=[],r=(a("d81d"),a("4de4"),a("d3b7"),a("25f0"),a("2591")),c={name:"MailingsSms",props:["usersData","message"],data:function(){return{select:!1,text:"",mailingsData:[],ref:"mailings"}},methods:{selectUsers:function(e){this.usersData.map((function(t){t.mailing=e}))},startMeiling:function(){var e=this.usersData.filter((function(e){return e.mailing})).map((function(e){return{id:e.id,telephone:e.phone,email:e.email}})),t={};t.text=this.text,t.users=e,this.mailingsData.push(t);var a=r["a"].database().ref(this.ref);a.set(this.mailingsData).then(this.text="",this.select="")}},computed:{textLength:function(){return this.text.toString().length},smsLength:function(){var e=this.usersData.filter((function(e){return e.mailing}));return e.length}},created:function(){var e=this,t=r["a"].database().ref(this.ref);t.on("value",(function(t){null!==t.val()&&(e.mailingsData=t.val())}))}},o=c,u=(a("d139"),a("2877")),f=Object(u["a"])(o,n,l,!1,null,"2a63f62c",null),d=f.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mailings__choose d-flex"},[a("p",[e._v("Выбрать пользователей для рассылки")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.select,expression:"select"}],attrs:{type:"radio",id:"allForEmail",value:"all"},domProps:{checked:e._q(e.select,"all")},on:{click:function(t){return e.selectUsers(!0)},change:function(t){e.select="all"}}}),a("label",{attrs:{for:"allForEmail"}},[e._v("Все пользователи")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.select,expression:"select"}],attrs:{type:"radio",id:"selectForEmail",value:"select"},domProps:{checked:e._q(e.select,"select")},on:{click:function(t){return e.selectUsers(!1)},change:function(t){e.select="select"}}}),a("label",{attrs:{for:"selectForEmail"}},[e._v("Выборочно")]),a("router-link",{staticClass:"users-choose btn btn-default",attrs:{disabled:"select"!==e.select,tag:"button",to:{name:"MailingsChoose",params:{way:"users-choose",usersData:e.usersData,message:e.file,mailingsData:e.mailingsData,ref:e.ref}}}},[e._v(" Выбрать пользователей ")])],1),a("div",{staticClass:"mailings__file"},[a("div",{staticClass:"mailings__file-info"},[a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.addFile}}),void 0!==e.file?a("p",[e._v(" Файл: "+e._s(e.file.name)+" "),void 0!==e.file?a("button",{staticClass:"btn btn-default",on:{click:function(t){return e.deleteFile()}}},[e._v(" Удалить ")]):e._e()]):e._e(),void 0===e.file?a("p",[e._v(" Загрузить файл: "),a("button",{staticClass:"btn btn-default",on:{click:e.openFileDialog}},[e._v(" Добавить ")])]):e._e(),a("p",[e._v("Количество писем: "+e._s(e.emailLength))])]),a("div",{staticClass:"mailings-start"},[a("button",{staticClass:"btn btn-default",attrs:{disabled:!0!==e.send},on:{click:function(t){return e.uploadFile()}}},[e._v(" Начать рассылку ")])])])])},v=[],h=(a("b0c0"),{name:"MailingsSms",props:["usersData"],data:function(){return{select:!1,file:void 0,send:!1,mailingsData:[],ref:"mailings"}},methods:{openFileDialog:function(){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(e)},addFile:function(){var e=this;this.file=this.$refs.fileDialog.files[0];var t=r["a"].storage().ref(this.ref);new Promise((function(a){a(t.child(e.file.name).put(e.file).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return{name:e.file.name,fileUrl:t}})))})).then((function(t){return e.file=t})).then(this.send=!0)},deleteFile:function(){var e=r["a"].storage().ref(this.ref);e.child(this.file.name).delete().then(this.send=!1).then(this.file=void 0)},selectUsers:function(e){this.usersData.map((function(t){t.mailing=e}))},uploadFile:function(){void 0!==this.file?this.startMeiling(this.file):alert("Выберети файл для рассылки")},startMeiling:function(e){var t=this.usersData.filter((function(e){return e.mailing})).map((function(e){return{id:e.id,telephone:e.phone,email:e.email}})),a={};a.file=e,a.users=t,this.mailingsData.push(a);var i=r["a"].database().ref(this.ref);i.set(this.mailingsData).then(this.file=void 0,this.select="")}},computed:{emailLength:function(){var e=this.usersData.filter((function(e){return e.mailing}));return e.length}},created:function(){var e=this,t=r["a"].database().ref(this.ref);t.on("value",(function(t){null!==t.val()&&(e.mailingsData=t.val())}))}}),g=h,p=(a("f6ac"),Object(u["a"])(g,m,v,!1,null,"0e2d57e2",null)),b=p.exports,_={name:"Mailings",components:{MailingsSms:d,MailingsEmail:b},data:function(){return{usersData:[]}},methods:{},created:function(){var e=this,t=r["a"].database().ref("users");t.on("value",(function(t){null!==t.val()&&(e.usersData=t.val())}))}},x=_,D=(a("ce79"),Object(u["a"])(x,i,s,!1,null,"093bced1",null));t["default"]=D.exports},"1dde":function(e,t,a){var i=a("d039"),s=a("b622"),n=a("2d00"),l=s("species");e.exports=function(e){return n>=51||!i((function(){var t=[],a=t.constructor={};return a[l]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"25f0":function(e,t,a){"use strict";var i=a("6eeb"),s=a("825a"),n=a("d039"),l=a("ad6d"),r="toString",c=RegExp.prototype,o=c[r],u=n((function(){return"/a/b"!=o.call({source:"a",flags:"b"})})),f=o.name!=r;(u||f)&&i(RegExp.prototype,r,(function(){var e=s(this),t=String(e.source),a=e.flags,i=String(void 0===a&&e instanceof RegExp&&!("flags"in c)?l.call(e):a);return"/"+t+"/"+i}),{unsafe:!0})},"40a2":function(e,t,a){},"4de4":function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").filter,n=a("1dde"),l=n("filter");i({target:"Array",proto:!0,forced:!l},{filter:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},"65f0":function(e,t,a){var i=a("861d"),s=a("e8b5"),n=a("b622"),l=n("species");e.exports=function(e,t){var a;return s(e)&&(a=e.constructor,"function"!=typeof a||a!==Array&&!s(a.prototype)?i(a)&&(a=a[l],null===a&&(a=void 0)):a=void 0),new(void 0===a?Array:a)(0===t?0:t)}},a426:function(e,t,a){},a717:function(e,t,a){},ad6d:function(e,t,a){"use strict";var i=a("825a");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},b0c0:function(e,t,a){var i=a("83ab"),s=a("9bf2").f,n=Function.prototype,l=n.toString,r=/^\s*function ([^ (]*)/,c="name";i&&!(c in n)&&s(n,c,{configurable:!0,get:function(){try{return l.call(this).match(r)[1]}catch(e){return""}}})},b727:function(e,t,a){var i=a("0366"),s=a("44ad"),n=a("7b0b"),l=a("50c4"),r=a("65f0"),c=[].push,o=function(e){var t=1==e,a=2==e,o=3==e,u=4==e,f=6==e,d=7==e,m=5==e||f;return function(v,h,g,p){for(var b,_,x=n(v),D=s(x),y=i(h,g,3),k=l(D.length),w=0,C=p||r,M=t?C(v,k):a||d?C(v,0):void 0;k>w;w++)if((m||w in D)&&(b=D[w],_=y(b,w,x),e))if(t)M[w]=_;else if(_)switch(e){case 3:return!0;case 5:return b;case 6:return w;case 2:c.call(M,b)}else switch(e){case 4:return!1;case 7:c.call(M,b)}return f?-1:o||u?u:M}};e.exports={forEach:o(0),map:o(1),filter:o(2),some:o(3),every:o(4),find:o(5),findIndex:o(6),filterOut:o(7)}},ce79:function(e,t,a){"use strict";a("40a2")},d139:function(e,t,a){"use strict";a("a717")},d81d:function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").map,n=a("1dde"),l=n("map");i({target:"Array",proto:!0,forced:!l},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},e8b5:function(e,t,a){var i=a("c6b6");e.exports=Array.isArray||function(e){return"Array"==i(e)}},f6ac:function(e,t,a){"use strict";a("a426")}}]);
//# sourceMappingURL=chunk-ad6cdeb2.84c9947e.js.map