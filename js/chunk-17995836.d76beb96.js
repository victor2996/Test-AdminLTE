(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17995836"],{4966:function(e,t,a){"use strict";a("7974")},"58be":function(e,t,a){"use strict";a("6624")},6624:function(e,t,a){},"66f1":function(e,t,a){},7974:function(e,t,a){},"7db0":function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").find,n=a("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),n(r)},b0c0:function(e,t,a){var i=a("83ab"),s=a("9bf2").f,n=Function.prototype,r=n.toString,o=/^\s*function ([^ (]*)/,l="name";i&&!(l in n)&&s(n,l,{configurable:!0,get:function(){try{return r.call(this).match(o)[1]}catch(e){return""}}})},d81d:function(e,t,a){"use strict";var i=a("23e7"),s=a("b727").map,n=a("1dde"),r=n("map");i({target:"Array",proto:!0,forced:!r},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},d8f9:function(e,t,a){"use strict";a("66f1")},da10:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block"},[a("div",{staticClass:"create"},[a("div",{staticClass:"create__status"},[a("div",{staticClass:"custom-control custom-switch custom-switch-on-success"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.status,expression:"newsData.status"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"customSwitch3"},domProps:{checked:Array.isArray(e.newsData.status)?e._i(e.newsData.status,null)>-1:e.newsData.status},on:{change:function(t){var a=e.newsData.status,i=t.target,s=!!i.checked;if(Array.isArray(a)){var n=null,r=e._i(a,n);i.checked?r<0&&e.$set(e.newsData,"status",a.concat([n])):r>-1&&e.$set(e.newsData,"status",a.slice(0,r).concat(a.slice(r+1)))}else e.$set(e.newsData,"status",s)}}}),e.newsData.status?a("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch3"}},[e._v(" Показывать ")]):a("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch3"}},[e._v("Не показывать ")])])]),a("div",{staticClass:"create__name d-flex"},[a("p",[e._v("Название новости")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.name,expression:"newsData.name"}],attrs:{type:"text",placeholder:"Название новости"},domProps:{value:e.newsData.name},on:{input:function(t){t.target.composing||e.$set(e.newsData,"name",t.target.value)}}}),a("p",{staticClass:"date-title"},[e._v("Дата публикации")]),a("DatePicker",{staticClass:"date-title",attrs:{date:e.newsData.date},on:{dateChange:e.newDateValue}})],1),a("div",{staticClass:"create__description d-flex"},[a("p",[e._v("Описание")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newsData.description,expression:"newsData.description"}],attrs:{type:"text",placeholder:"Описание"},domProps:{value:e.newsData.description},on:{input:function(t){t.target.composing||e.$set(e.newsData,"description",t.target.value)}}})]),a("div",{staticClass:"create__main-img d-flex"},[a("p",[e._v("Главная картинка")]),a("NewsAddImage",{attrs:{sourceData:e.newsData.mainImage},on:{mainImageChanged:e.mainImageFile}})],1),a("div",{staticClass:"create__gallery"},[a("p",[e._v("Галерея картинок")]),a("div",{staticClass:"d-flex"},[a("p",[e._v("Размер: 1000х190")]),a("div",{staticClass:"create__gallery-img d-flex flex-wrap"},[e._l(e.galleryData,(function(t,i){return a("NewsAddGallery",{key:t.name,staticClass:"gallery__block",attrs:{data:t},on:{remove:function(t){return e.galleryData.splice(i,1)}}})})),a("button",{staticClass:"btn btn-default gallery__block-add",on:{click:function(t){return e.openFileDialog()}}},[a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.addImage}}),e._v(" Добавить"),a("br"),e._v("фото ")])],2)])]),a("div",{staticClass:"create__link d-flex"},[a("p",[e._v("Ссылка на видео")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.link,expression:"newsData.link"}],attrs:{type:"text",placeholder:"Ссылка на видео в YouTube"},domProps:{value:e.newsData.link},on:{input:function(t){t.target.composing||e.$set(e.newsData,"link",t.target.value)}}})]),a("div",{staticClass:"create__seo d-flex"},[a("p",[e._v("SEO блок:")]),a("div",{staticClass:"create__seo-info"},[a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("URL:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.SEO.url,expression:"newsData.SEO.url"}],attrs:{type:"text",placeholder:"URL"},domProps:{value:e.newsData.SEO.url},on:{input:function(t){t.target.composing||e.$set(e.newsData.SEO,"url",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Title:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.SEO.title,expression:"newsData.SEO.title"}],attrs:{type:"text",placeholder:"Title"},domProps:{value:e.newsData.SEO.title},on:{input:function(t){t.target.composing||e.$set(e.newsData.SEO,"title",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Keywords:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.SEO.keyword,expression:"newsData.SEO.keyword"}],attrs:{type:"text",placeholder:"word"},domProps:{value:e.newsData.SEO.keyword},on:{input:function(t){t.target.composing||e.$set(e.newsData.SEO,"keyword",t.target.value)}}})]),a("div",{staticClass:"create__seo-info-block d-flex"},[a("p",[e._v("Description:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.newsData.SEO.description,expression:"newsData.SEO.description"}],attrs:{type:"text",placeholder:"Description"},domProps:{value:e.newsData.SEO.description},on:{input:function(t){t.target.composing||e.$set(e.newsData.SEO,"description",t.target.value)}}})])])])]),a("button",{ref:"btnSave",staticClass:"btn btn-default btn-save",on:{click:e.mainImagePromise}},[e._v(" Сохранить ")])])},s=[],n=(a("b0c0"),a("d3b7"),a("4de4"),a("3ca3"),a("ddb0"),a("d81d"),a("7db0"),a("99af"),a("b64b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-block flex-wrap"},[void 0!==e.imageData?a("img",{ref:"filePreview",staticClass:"preview",attrs:{src:e.imageData}}):e._e(),a("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.addImage}}),void 0===e.imageData?a("button",{staticClass:"btn btn-default",on:{click:e.openFileDialog}},[e._v(" Добавить ")]):e._e(),void 0!==e.imageData?a("button",{staticClass:"btn btn-default info-block__remove",on:{click:e.deleteImage}},[e._v(" Удалить ")]):e._e()])}),r=[],o={name:"NewsAddImage",props:["sourceData"],data:function(){return{imageData:this.sourceData}},methods:{openFileDialog:function(){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(e)},addImage:function(){var e=this.$refs.fileDialog.files[0];this.previewImage(e)},previewImage:function(e){var t=this,a=new FileReader;a.readAsDataURL(e),a.onload=function(e){t.imageData=e.target.result},this.$emit("mainImageChanged",e)},deleteImage:function(){this.imageData=void 0,this.$emit("mainImageChanged",void 0)}},mounted:function(){void 0!==this.imageData&&(null!==this.imageData.imageUrl&&void 0!==this.imageData.imageUrl?this.$refs.filePreview.src=this.imageData.imageUrl:this.previewImage(this.imageData.imageFile))}},l=o,c=(a("4966"),a("2877")),d=Object(c["a"])(l,n,r,!1,null,"6990e138",null),u=d.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info-block"},[a("div",{staticClass:"btn btn-default info-block__close",on:{click:function(t){return e.$emit("remove")}}},[a("svg",{staticClass:"info-block__close-img",attrs:{viewBox:"0 0 8 8"}},[a("path",{attrs:{d:"M1.406 0l-1.406 1.406.688.719 1.781 1.781-1.781 1.781-.688.719 1.406 1.406.719-.688 1.781-1.781 1.781 1.781.719.688 1.406-1.406-.688-.719-1.781-1.781 1.781-1.781.688-.719-1.406-1.406-.719.688-1.781 1.781-1.781-1.781-.719-.688z",id:"x",fill:"rgba(0,0,0,0.7)"}})])]),a("img",{ref:"filePreview",staticClass:"info-block__image"})])},f=[],v={name:"NewsAddGallery",props:["data"],data:function(){return{dataSource:this.data}},methods:{previewImage:function(e){var t=this.$refs.filePreview,a=new FileReader;a.onload=function(e){t.src=e.target.result},a.readAsDataURL(e),this.dataSource.name=e.name,this.dataSource.imageFile=e}},mounted:function(){null!==this.dataSource.imageUrl&&void 0!==this.dataSource.imageUrl?this.$refs.filePreview.src=this.dataSource.imageUrl:this.previewImage(this.dataSource.imageFile)}},g=v,h=(a("58be"),Object(c["a"])(g,m,f,!1,null,"10a29d08",null)),p=h.exports,w=a("4dab"),D=a("2591"),b={name:"NewsAdd",components:{NewsAddImage:u,NewsAddGallery:p,DatePicker:w["a"]},props:["dataArr","dataOb","dbRef","dbMainImageRef","dbGalleryRef"],data:function(){return{ref:this.dbRef,mainImageRef:this.dbMainImageRef,galleryRef:this.dbGalleryRef,dataSource:[],galleryData:[],newsData:{id:"",name:"",status:!1,date:"",description:"",galleryImages:[],link:"",SEO:{url:"",title:"",keyword:"",description:""}}}},methods:{openFileDialog:function(){this.$refs.fileDialog.click()},addImage:function(){var e=this.$refs.fileDialog.files[0];void 0!==e&&this.galleryData.push({name:e.name,imageFile:e})},mainImageFile:function(e){void 0!==e&&(this.newsData.mainImage=e)},newDateValue:function(e){this.newsData.date=e},mainImagePromise:function(){var e=this;this.$refs.btnSave.classList.add("show"),this.$refs.btnSave.textContent="Сохраняется";var t=D["a"].storage().ref(this.mainImageRef);void 0!==this.newsData.mainImage&&void 0===this.newsData.mainImage.imageUrl?new Promise((function(a){a(t.child(e.newsData.mainImage.name).put(e.newsData.mainImage).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return{name:e.newsData.mainImage.name,imageUrl:t}})))})).then((function(t){return e.galleryPromise(t)})):void 0!==this.newsData.mainImage&&void 0!==this.newsData.mainImage.imageUrl?this.galleryPromise(this.newsData.mainImage):(alert("Укажите главную картинку"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},galleryPromise:function(e){var t=this,a=D["a"].storage().ref(this.galleryRef);if(this.galleryData.length>0){var i=this.galleryData.filter((function(e){return void 0===e.id}));Promise.all(i.map((function(e){if(void 0!==e.imageFile)return new Promise((function(t){t(a.child(e.name).put(e.imageFile).then((function(e){return e.ref.getDownloadURL()})).then((function(t){return e={id:Math.floor(1e4*Math.random()),name:e.name,imageUrl:t}})))}))}))).then((function(a){return t.saveData(e,a)}))}else alert("Выберете картинки для галереи"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show")},saveData:function(e,t){var a=this,i=this.dataSource.find((function(e){return e.id===a.newsData.id}));if(void 0!==i){var s=this.galleryData.filter((function(e){return void 0!==e.id})),n=s.concat(t);this.onUpload(e,n)}else this.onUpload(e,t)},onUpload:function(e,t){var a=this,i=this.dataSource.filter((function(e){return e.id!==a.newsData.id}));this.newsData.id=Math.floor(1e4*Math.random()),this.newsData.mainImage=e,this.newsData.galleryImages=t,i.push(this.newsData);var s=D["a"].database().ref(this.ref);s.set(i).then(this.$refs.btnSave.textContent="Сохранено").then(this.$refs.btnSave.classList.remove("show")).then(this.$router.push("/admin/news"))}},created:function(){void 0!==this.dataArr&&this.dataArr.length>0?(this.dataSource=this.dataArr,void 0!==this.dataOb&&0!==Object.keys(this.dataOb).length&&(this.newsData=this.dataOb,0!==this.dataOb.galleryImages.length&&(this.galleryData=this.dataOb.galleryImages))):void 0===this.dataArr&&this.$router.push("/admin/news")}},_=b,y=(a("d8f9"),Object(c["a"])(_,i,s,!1,null,"7976defd",null));t["default"]=y.exports}}]);
//# sourceMappingURL=chunk-17995836.d76beb96.js.map