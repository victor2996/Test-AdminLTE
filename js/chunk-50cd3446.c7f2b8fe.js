(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50cd3446"],{"0d40":function(a,t,e){"use strict";e("d551")},"14f7":function(a,t,e){},"16ff":function(a,t,e){"use strict";e("d140")},"1dde":function(a,t,e){var i=e("d039"),n=e("b622"),r=e("2d00"),l=n("species");a.exports=function(a){return r>=51||!i((function(){var t=[],e=t.constructor={};return e[l]=function(){return{foo:1}},1!==t[a](Boolean).foo}))}},"25f0":function(a,t,e){"use strict";var i=e("6eeb"),n=e("825a"),r=e("d039"),l=e("ad6d"),o="toString",s=RegExp.prototype,c=s[o],d=r((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=c.name!=o;(d||u)&&i(RegExp.prototype,o,(function(){var a=n(this),t=String(a.source),e=a.flags,i=String(void 0===e&&a instanceof RegExp&&!("flags"in s)?l.call(a):e);return"/"+t+"/"+i}),{unsafe:!0})},"4de4":function(a,t,e){"use strict";var i=e("23e7"),n=e("b727").filter,r=e("1dde"),l=r("filter");i({target:"Array",proto:!0,forced:!l},{filter:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}})},"52b2":function(a,t,e){},"65f0":function(a,t,e){var i=e("861d"),n=e("e8b5"),r=e("b622"),l=r("species");a.exports=function(a,t){var e;return n(a)&&(e=a.constructor,"function"!=typeof e||e!==Array&&!n(e.prototype)?i(e)&&(e=e[l],null===e&&(e=void 0)):e=void 0),new(void 0===e?Array:e)(0===t?0:t)}},"6c61":function(a,t,e){"use strict";e("52b2")},"7db0":function(a,t,e){"use strict";var i=e("23e7"),n=e("b727").find,r=e("44d2"),l="find",o=!0;l in[]&&Array(1)[l]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{find:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}}),r(l)},8418:function(a,t,e){"use strict";var i=e("c04e"),n=e("9bf2"),r=e("5c6c");a.exports=function(a,t,e){var l=i(t);l in a?n.f(a,l,r(0,e)):a[l]=e}},"962e":function(a,t,e){"use strict";e("14f7")},"99af":function(a,t,e){"use strict";var i=e("23e7"),n=e("d039"),r=e("e8b5"),l=e("861d"),o=e("7b0b"),s=e("50c4"),c=e("8418"),d=e("65f0"),u=e("1dde"),f=e("b622"),m=e("2d00"),h=f("isConcatSpreadable"),g=9007199254740991,v="Maximum allowed index exceeded",p=m>=51||!n((function(){var a=[];return a[h]=!1,a.concat()[0]!==a})),b=u("concat"),D=function(a){if(!l(a))return!1;var t=a[h];return void 0!==t?!!t:r(a)},y=!p||!b;i({target:"Array",proto:!0,forced:y},{concat:function(a){var t,e,i,n,r,l=o(this),u=d(l,0),f=0;for(t=-1,i=arguments.length;t<i;t++)if(r=-1===t?l:arguments[t],D(r)){if(n=s(r.length),f+n>g)throw TypeError(v);for(e=0;e<n;e++,f++)e in r&&c(u,f,r[e])}else{if(f>=g)throw TypeError(v);c(u,f++,r)}return u.length=f,u}})},ad6d:function(a,t,e){"use strict";var i=e("825a");a.exports=function(){var a=i(this),t="";return a.global&&(t+="g"),a.ignoreCase&&(t+="i"),a.multiline&&(t+="m"),a.dotAll&&(t+="s"),a.unicode&&(t+="u"),a.sticky&&(t+="y"),t}},b0ab:function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main-block"},[e("div",{staticClass:"create"},[e("div",{staticClass:"create__number d-flex"},[e("p",[a._v("Номер зала")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.hallData.number,expression:"hallData.number"}],attrs:{type:"text",placeholder:"Номер зала"},domProps:{value:a.hallData.number},on:{input:function(t){t.target.composing||a.$set(a.hallData,"number",t.target.value)}}})]),e("div",{staticClass:"create__description d-flex"},[e("p",[a._v("Описание зала")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:a.hallData.description,expression:"hallData.description"}],attrs:{type:"text",placeholder:"Описание"},domProps:{value:a.hallData.description},on:{input:function(t){t.target.composing||a.$set(a.hallData,"description",t.target.value)}}})]),e("div",{staticClass:"create__main-img d-flex"},[e("p",[a._v("Схема зала")]),e("HallAddPlanImage",{attrs:{sourceData:a.hallData.plan},on:{mainImageChanged:a.mainImageFile}})],1),e("div",{staticClass:"create__main-img d-flex"},[e("p",[a._v("Верхний баннер")]),e("HallAddBannerImage",{attrs:{sourceData:a.hallData.banner},on:{topBannerChanged:a.topBannerFile}})],1),e("div",{staticClass:"create__gallery"},[e("p",[a._v("Галерея картинок")]),e("div",{staticClass:"d-flex"},[e("p",[a._v("Размер: 1000х190")]),e("div",{staticClass:"create__gallery-img d-flex flex-wrap"},[a._l(a.galleryData,(function(t,i){return e("HallAddGallery",{key:t.name,staticClass:"gallery__block",attrs:{data:t},on:{remove:function(t){return a.galleryData.splice(i,1)}}})})),e("button",{staticClass:"btn btn-default gallery__block-add",on:{click:function(t){return a.openFileDialog()}}},[e("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:a.addImage}}),a._v(" Добавить"),e("br"),a._v("фото ")])],2)])]),e("div",{staticClass:"create__seo d-flex"},[e("p",[a._v("SEO блок:")]),e("div",{staticClass:"create__seo-info"},[e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("URL:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.hallData.SEO.url,expression:"hallData.SEO.url"}],attrs:{type:"text",placeholder:"URL"},domProps:{value:a.hallData.SEO.url},on:{input:function(t){t.target.composing||a.$set(a.hallData.SEO,"url",t.target.value)}}})]),e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("Title:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.hallData.SEO.title,expression:"hallData.SEO.title"}],attrs:{type:"text",placeholder:"Title"},domProps:{value:a.hallData.SEO.title},on:{input:function(t){t.target.composing||a.$set(a.hallData.SEO,"title",t.target.value)}}})]),e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("Keywords:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.hallData.SEO.keyword,expression:"hallData.SEO.keyword"}],attrs:{type:"text",placeholder:"word"},domProps:{value:a.hallData.SEO.keyword},on:{input:function(t){t.target.composing||a.$set(a.hallData.SEO,"keyword",t.target.value)}}})]),e("div",{staticClass:"create__seo-info-block d-flex"},[e("p",[a._v("Description:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.hallData.SEO.description,expression:"hallData.SEO.description"}],attrs:{type:"text",placeholder:"Description"},domProps:{value:a.hallData.SEO.description},on:{input:function(t){t.target.composing||a.$set(a.hallData.SEO,"description",t.target.value)}}})])])])]),e("button",{ref:"btnSave",staticClass:"btn btn-default btn-save",on:{click:a.mainImagePromise}},[a._v(" Сохранить ")]),e("router-link",{staticClass:"btn btn-default btn-save",attrs:{tag:"button",to:{name:"CinemaAdd",params:{way:"add-cinema",dataArr:a.cinemaDataArr,dataOb:a.cinemaDataOb,dataImg:a.mainImageData,dataBanner:a.topBannerData,dataGallery:a.galleryImgData,dataHall:a.dataSource,dbRef:"cinema",dbMainImageRef:"cinema/main",dbTopBannerRef:"cinema/banner",dbGalleryRef:"cinema/gallery"}}}},[a._v("Вернуться")])],1)},n=[],r=(e("b0c0"),e("d3b7"),e("4de4"),e("3ca3"),e("ddb0"),e("d81d"),e("7db0"),e("99af"),e("25f0"),e("b64b"),function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main-block flex-wrap"},[void 0!==a.imageData?e("img",{ref:"filePreview",staticClass:"preview",attrs:{src:a.imageData}}):a._e(),e("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:a.addImage}}),void 0===a.imageData?e("button",{staticClass:"btn btn-default",on:{click:a.openFileDialog}},[a._v(" Добавить ")]):a._e(),void 0!==a.imageData?e("button",{staticClass:"btn btn-default info-block__remove",on:{click:a.deleteImage}},[a._v(" Удалить ")]):a._e()])}),l=[],o={name:"HallAddPlanImage",props:["sourceData"],data:function(){return{imageData:this.sourceData}},methods:{openFileDialog:function(){var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(a)},addImage:function(){var a=this.$refs.fileDialog.files[0];this.previewImage(a)},previewImage:function(a){var t=this,e=new FileReader;e.readAsDataURL(a),e.onload=function(a){t.imageData=a.target.result},this.$emit("mainImageChanged",a)},deleteImage:function(){this.imageData=void 0,this.$emit("mainImageChanged",void 0)}},mounted:function(){void 0!==this.imageData&&(null!==this.imageData.imageUrl&&void 0!==this.imageData.imageUrl?this.$refs.filePreview.src=this.imageData.imageUrl:this.previewImage(this.imageData.imageFile))}},s=o,c=(e("0d40"),e("2877")),d=Object(c["a"])(s,r,l,!1,null,"1385b3be",null),u=d.exports,f=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main-block flex-wrap"},[void 0!==a.imageData?e("img",{ref:"filePreview",staticClass:"preview",attrs:{src:a.imageData}}):a._e(),e("input",{ref:"fileDialog",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:a.addImage}}),void 0===a.imageData?e("button",{staticClass:"btn btn-default",on:{click:a.openFileDialog}},[a._v(" Добавить ")]):a._e(),void 0!==a.imageData?e("button",{staticClass:"btn btn-default info-block__remove",on:{click:a.deleteImage}},[a._v(" Удалить ")]):a._e()])},m=[],h={name:"HallAddBannerImage",props:["sourceData"],data:function(){return{imageData:this.sourceData}},methods:{openFileDialog:function(){var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.$refs.fileDialog.dispatchEvent(a)},addImage:function(){var a=this.$refs.fileDialog.files[0];this.previewImage(a)},previewImage:function(a){var t=this,e=new FileReader;e.readAsDataURL(a),e.onload=function(a){t.imageData=a.target.result},this.$emit("topBannerChanged",a)},deleteImage:function(){this.imageData=void 0,this.$emit("topBannerChanged",void 0)}},mounted:function(){void 0!==this.imageData&&(null!==this.imageData.imageUrl&&void 0!==this.imageData.imageUrl?this.$refs.filePreview.src=this.imageData.imageUrl:this.previewImage(this.imageData.imageFile))}},g=h,v=(e("16ff"),Object(c["a"])(g,f,m,!1,null,"cd35e0b4",null)),p=v.exports,b=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"info-block"},[e("div",{staticClass:"btn btn-default info-block__close",on:{click:function(t){return a.$emit("remove")}}},[e("svg",{staticClass:"info-block__close-img",attrs:{viewBox:"0 0 8 8"}},[e("path",{attrs:{d:"M1.406 0l-1.406 1.406.688.719 1.781 1.781-1.781 1.781-.688.719 1.406 1.406.719-.688 1.781-1.781 1.781 1.781.719.688 1.406-1.406-.688-.719-1.781-1.781 1.781-1.781.688-.719-1.406-1.406-.719.688-1.781 1.781-1.781-1.781-.719-.688z",id:"x",fill:"rgba(0,0,0,0.7)"}})])]),e("img",{ref:"filePreview",staticClass:"info-block__image"})])},D=[],y={name:"HallAddGallery",props:["data"],data:function(){return{dataSource:this.data}},methods:{previewImage:function(a){var t=this.$refs.filePreview,e=new FileReader;e.onload=function(a){t.src=a.target.result},e.readAsDataURL(a),this.dataSource.name=a.name,this.dataSource.imageFile=a}},mounted:function(){null!==this.dataSource.imageUrl&&void 0!==this.dataSource.imageUrl?this.$refs.filePreview.src=this.dataSource.imageUrl:this.previewImage(this.dataSource.imageFile)}},_=y,w=(e("6c61"),Object(c["a"])(_,b,D,!1,null,"b81b8044",null)),S=w.exports,I=e("2591"),x={name:"HallAdd",components:{HallAddPlanImage:u,HallAddBannerImage:p,HallAddGallery:S},props:["dataArrS","dataObS","dataImgS","dataBannerS","dataGalleryS","hallDataS","hallDataObS"],data:function(){return{cinemaDataArr:this.dataArrS,cinemaDataOb:this.dataObS,mainImageData:this.dataImgS,topBannerData:this.dataBannerS,galleryImgData:this.dataGalleryS,hallDataArr:this.hallDataS,hallDataOb:this.hallDataObS,dataSource:[],galleryData:[],planImage:"",bannerImage:"",hallData:{id:"",number:"",description:"",SEO:{url:"",title:"",keyword:"",description:""}}}},methods:{openFileDialog:function(){this.$refs.fileDialog.click()},addImage:function(){var a=this.$refs.fileDialog.files[0];void 0!==a&&this.galleryData.push({name:a.name,imageFile:a})},mainImageFile:function(a){void 0!==a&&(this.planImage=a)},topBannerFile:function(a){void 0!==a&&(this.bannerImage=a)},mainImagePromise:function(){var a=this;this.$refs.btnSave.classList.add("show"),this.$refs.btnSave.textContent="Сохраняется";var t=I["a"].storage().ref("cinema/hall/plan");void 0!==this.planImage.name?new Promise((function(e){e(t.child(a.planImage.name).put(a.planImage).then((function(a){return a.ref.getDownloadURL()})).then((function(t){return{name:a.planImage.name,imageUrl:t}})))})).then((function(t){return a.topBannerPromise(t)})):void 0!==this.hallData.plan?this.topBannerPromise(this.hallData.plan):(alert("Укажите план зала"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},topBannerPromise:function(a){var t=this,e=I["a"].storage().ref("cinema/hall/banner");void 0!==this.bannerImage.name?new Promise((function(a){a(e.child(t.bannerImage.name).put(t.bannerImage).then((function(a){return a.ref.getDownloadURL()})).then((function(a){return{name:t.bannerImage.name,imageUrl:a}})))})).then((function(e){return t.galleryPromise(a,e)})):void 0!==this.hallData.banner?this.galleryPromise(a,this.hallData.banner):(alert("Укажите банер зала"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show"))},galleryPromise:function(a,t){var e=this,i=I["a"].storage().ref("cinema/hall/gallery");if(this.galleryData.length>0){var n=this.galleryData.filter((function(a){return void 0===a.id}));Promise.all(n.map((function(a){if(void 0!==a.imageFile)return new Promise((function(t){t(i.child(a.name).put(a.imageFile).then((function(a){return a.ref.getDownloadURL()})).then((function(t){return a={id:Math.floor(1e4*Math.random()),name:a.name,imageUrl:t}})))}))}))).then((function(i){return e.saveData(a,t,i)}))}else alert("Выберете картинки для галереи"),this.$refs.btnSave.textContent="Сохранить",this.$refs.btnSave.classList.remove("show")},saveData:function(a,t,e){var i=this,n=this.dataSource.find((function(a){return a.id===i.hallData.id}));if(void 0!==n){var r=this.galleryData.filter((function(a){return void 0!==a.id})),l=r.concat(e);this.onUpload(a,t,l)}else this.onUpload(a,t,e)},onUpload:function(a,t,e){var i,n,r=this,l=this.dataSource.filter((function(a){return a.id!==r.hallData.id})),o=new Date;1===o.getDate().toString().length&&(i="0"+o.getDate()),1===o.getMonth().toString().length&&(n="0"+o.getMonth());var s=o.getFullYear(),c="".concat(i,".").concat(n,".").concat(s);this.hallData.date=c,this.hallData.id=Math.floor(1e4*Math.random()),this.hallData.plan=a,this.hallData.banner=t,this.hallData.gallery=e,l.push(this.hallData),this.dataSource=l,this.$refs.btnSave.textContent="Сохранено",this.$refs.btnSave.classList.remove("show"),this.$refs.btnSave.classList.add("hide")}},created:function(){void 0!==this.cinemaDataArr&&this.cinemaDataArr.length>0?void 0!==this.hallDataArr&&this.hallDataArr.length>0&&(this.dataSource=this.hallDataArr,void 0!==this.hallDataOb&&0!==Object.keys(this.hallDataOb).length&&(this.hallData=this.hallDataOb,this.galleryData=this.hallDataOb.gallery)):this.$router.push("/admin/cinema")}},C=x,k=(e("962e"),Object(c["a"])(C,i,n,!1,null,"7082874e",null));t["default"]=k.exports},b0c0:function(a,t,e){var i=e("83ab"),n=e("9bf2").f,r=Function.prototype,l=r.toString,o=/^\s*function ([^ (]*)/,s="name";i&&!(s in r)&&n(r,s,{configurable:!0,get:function(){try{return l.call(this).match(o)[1]}catch(a){return""}}})},b64b:function(a,t,e){var i=e("23e7"),n=e("7b0b"),r=e("df75"),l=e("d039"),o=l((function(){r(1)}));i({target:"Object",stat:!0,forced:o},{keys:function(a){return r(n(a))}})},b727:function(a,t,e){var i=e("0366"),n=e("44ad"),r=e("7b0b"),l=e("50c4"),o=e("65f0"),s=[].push,c=function(a){var t=1==a,e=2==a,c=3==a,d=4==a,u=6==a,f=7==a,m=5==a||u;return function(h,g,v,p){for(var b,D,y=r(h),_=n(y),w=i(g,v,3),S=l(_.length),I=0,x=p||o,C=t?x(h,S):e||f?x(h,0):void 0;S>I;I++)if((m||I in _)&&(b=_[I],D=w(b,I,y),a))if(t)C[I]=D;else if(D)switch(a){case 3:return!0;case 5:return b;case 6:return I;case 2:s.call(C,b)}else switch(a){case 4:return!1;case 7:s.call(C,b)}return u?-1:c||d?d:C}};a.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},d140:function(a,t,e){},d551:function(a,t,e){},d81d:function(a,t,e){"use strict";var i=e("23e7"),n=e("b727").map,r=e("1dde"),l=r("map");i({target:"Array",proto:!0,forced:!l},{map:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}})},e8b5:function(a,t,e){var i=e("c6b6");a.exports=Array.isArray||function(a){return"Array"==i(a)}}}]);
//# sourceMappingURL=chunk-50cd3446.c7f2b8fe.js.map